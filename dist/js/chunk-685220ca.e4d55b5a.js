(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-685220ca"],{"0667":function(e,t,n){"use strict";var i=n("5e38"),r=n.n(i);r.a},"0bf8":function(e,t,n){"use strict";var i=n("2e9c"),r=n.n(i);r.a},"10aa":function(e,t){e.exports="data:image/png;base64,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"},"117b":function(e,t,n){},1216:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAEYBAMAAAB1oPS/AAAAMFBMVEXY2Nj////6+vr09PTv7+/b29vl5eXy8vL8/Pzo6Oji4uL29vbf39/d3d3s7Ozq6uoYF1TfAAADhklEQVR42u3ay+sNYRgH8K/LuP8c3+N+zSiSFVlQLJzcLTRkI5eQhCS/KAurIzbIraQot7Jg5X7ZsbBRymWDhSgLCwuystMRDuaMGYd53ie+n7/gbeZ5n3nmeR6IiIiIiIiIiIiIiIiIiIiIiIiIeNDv1K6J3H1z4XkE1/Ghzi+unUFYyy+zqboIIa2u8wc3EM6yOn8yAaH0iJkyE2FEU9jCOwRxjq0MTBBAha0dQAA1tjbsDMz1ZJYhMNfJTGtgrDuzjYCxI8w27A5M9eOvjIeppfyVoTDVyV86DEN9+Gt7Yagr6ec9HWEOyywcM8dkmOnNPKNgpivpJ2jOMlcCKzWS9JJp6sx1CUb6MN9gGOnPb8JXWH2ZbxCMdGG+Kow8YgEwspYF3IGN9/wmfFVeI/1kvUKHeQcbnSzgJTLZH2YWWvunn4yrmHF1m155yjOFMvBD2LjLfMNgZAnzjYSRrp7qme6eKr0ezDcARiKSfv5vp/hJM8BaPzcb6OXnMhW5TqNhJmKebbBT8/JlanjqJ2SACumoKx17yTINZ7000Roqjt4SMMXRVAVLPZQPX0Wxl/BteMwsw2GuI/bzYIAVbG0fAog62crIhwihdz27+2DvCdMmIZR1/NkhhHOUPzqYIKCT/N7tBEG9aKab6luEFq2/xYb98xJ4sPLihov3ICL/hOends64Mu4nV6ct3JLAWLR1OrNUF96BpWeXmRJqMfgk8+x5CBsdC5hv4BpYiGosompxmugNixloEMbr+JmLjv0yZrEvzvvF/MLBnHIjU4I1jSr8PddRohp/T7XE3NedKeHanq/4u6oJStKbKcZbael+q4sLlW7jBZz8d2Mm+5XTI0wJNuCO6qSb99STmez3ye8yJVwl0cks9lO5fmzXLDS4CJlStnGXsF1jkGKwQ2m3AHuZbTsDAD7it4QIrrB9Y9Fk8JU0XozoxVxmo7lmYeWhwHpP+rnbNf4BwE2a+fvL7XUWYDTPjViE0W5wB//ELMDL1+CvH6YP/8S2f/gwPfgnJusw/+FhXAVwB4uwasHGLMCqIn/FfGb1zFK2bwQAeIngWWiy2hs37In0idmeYWVMwSr19s4yF2Xo3U4dPPIYyhEdj/l7qgsTlCa6MPsWi9q/40SCkq26v+n06znzd26f2tq0nTvmLP64+YGPrScRERERERERERERERERERERERH533wC+A/UTiY/H6UAAAAASUVORK5CYII="},1677:function(e,t,n){"use strict";var i=n("6201"),r=n.n(i);r.a},"1c79":function(e,t,n){"use strict";var i=n("d360"),r=n.n(i);r.a},2489:function(e,t,n){},"28a5":function(e,t,n){"use strict";var i=n("aae3"),r=n("cb7c"),o=n("ebd6"),s=n("0390"),a=n("9def"),c=n("5f1b"),l=n("520a"),u=n("79e5"),d=Math.min,m=[].push,h="split",f="length",v="lastIndex",g=4294967295,p=!u((function(){RegExp(g,"y")}));n("214f")("split",2,(function(e,t,n,u){var w;return w="c"=="abbc"[h](/(b)*/)[1]||4!="test"[h](/(?:)/,-1)[f]||2!="ab"[h](/(?:ab)*/)[f]||4!="."[h](/(.?)(.?)/)[f]||"."[h](/()()/)[f]>1||""[h](/.?/)[f]?function(e,t){var r=String(this);if(void 0===e&&0===t)return[];if(!i(e))return n.call(r,e,t);var o,s,a,c=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),d=0,h=void 0===t?g:t>>>0,p=new RegExp(e.source,u+"g");while(o=l.call(p,r)){if(s=p[v],s>d&&(c.push(r.slice(d,o.index)),o[f]>1&&o.index<r[f]&&m.apply(c,o.slice(1)),a=o[0][f],d=s,c[f]>=h))break;p[v]===o.index&&p[v]++}return d===r[f]?!a&&p.test("")||c.push(""):c.push(r.slice(d)),c[f]>h?c.slice(0,h):c}:"0"[h](void 0,0)[f]?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,i){var r=e(this),o=void 0==n?void 0:n[t];return void 0!==o?o.call(n,r,i):w.call(String(r),n,i)},function(e,t){var i=u(w,e,this,t,w!==n);if(i.done)return i.value;var l=r(e),m=String(this),h=o(l,RegExp),f=l.unicode,v=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(p?"y":"g"),b=new h(p?l:"^(?:"+l.source+")",v),y=void 0===t?g:t>>>0;if(0===y)return[];if(0===m.length)return null===c(b,m)?[m]:[];var O=0,R=0,E=[];while(R<m.length){b.lastIndex=p?R:0;var I,k=c(b,p?m:m.slice(R));if(null===k||(I=d(a(b.lastIndex+(p?0:R)),m.length))===O)R=s(m,R,f);else{if(E.push(m.slice(O,R)),E.length===y)return E;for(var x=1;x<=k.length-1;x++)if(E.push(k[x]),E.length===y)return E;R=O=I}}return E.push(m.slice(O)),E}]}))},2937:function(e,t,n){},"2adc":function(e,t,n){},"2e9c":function(e,t,n){},"302e":function(e,t,n){"use strict";var i=n("fba3"),r=n.n(i);r.a},3290:function(e,t,n){},"386d":function(e,t,n){"use strict";var i=n("cb7c"),r=n("83a1"),o=n("5f1b");n("214f")("search",1,(function(e,t,n,s){return[function(n){var i=e(this),r=void 0==n?void 0:n[t];return void 0!==r?r.call(n,i):new RegExp(n)[t](String(i))},function(e){var t=s(n,e,this);if(t.done)return t.value;var a=i(e),c=String(this),l=a.lastIndex;r(l,0)||(a.lastIndex=0);var u=o(a,c);return r(a.lastIndex,l)||(a.lastIndex=l),null===u?-1:u.index}]}))},"3f94":function(e,t,n){"use strict";var i=n("2adc"),r=n.n(i);r.a},"49f0":function(e,t,n){e.exports=n.p+"img/room_video_play.0276ada7.svg"},"4b04":function(e,t,n){"use strict";var i=n("117b"),r=n.n(i);r.a},"5a71":function(e,t,n){"use strict";var i=n("91ff"),r=n.n(i);r.a},"5d73":function(e,t,n){e.exports=n("469f")},"5e38":function(e,t,n){},6201:function(e,t,n){},"6f36":function(e,t,n){},7040:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RUE3OTQ2MzdENDA5MTFFNzkyMTZERkM3QjMwMjQ0NDEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RUE3OTQ2MzhENDA5MTFFNzkyMTZERkM3QjMwMjQ0NDEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFQTc5NDYzNUQ0MDkxMUU3OTIxNkRGQzdCMzAyNDQ0MSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFQTc5NDYzNkQ0MDkxMUU3OTIxNkRGQzdCMzAyNDQ0MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PhUP6hoAAAhNSURBVHja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"},"704f":function(e,t,n){e.exports=n.p+"img/input_emoji_default.c5205078.svg"},"7b61":function(e,t,n){"use strict";var i=n("c95f"),r=n.n(i);r.a},"7c18":function(e,t,n){"use strict";var i=n("3290"),r=n.n(i);r.a},"81a7":function(e,t,n){"use strict";var i=n("a0f3"),r=n.n(i);r.a},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"8e92":function(e,t,n){"use strict";var i=n("2489"),r=n.n(i);r.a},"91ff":function(e,t,n){},9834:function(e,t,n){},9865:function(e,t,n){"use strict";var i=n("5ca1"),r=n("6821"),o=n("4588"),s=n("9def"),a=[].lastIndexOf,c=!!a&&1/[1].lastIndexOf(1,-0)<0;i(i.P+i.F*(c||!n("2f21")(a)),"Array",{lastIndexOf:function(e){if(c)return a.apply(this,arguments)||0;var t=r(this),n=s(t.length),i=n-1;for(arguments.length>1&&(i=Math.min(i,o(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in t&&t[i]===e)return i||0;return-1}})},"9eec":function(e,t,n){"use strict";var i=n("cf7e"),r=n.n(i);r.a},a0ad:function(e,t,n){e.exports=n.p+"img/room_down.0f55b7d8.svg"},a0f3:function(e,t,n){},b91d:function(e,t,n){"use strict";var i=n("6f36"),r=n.n(i);r.a},bbc4:function(e,t,n){},c70d:function(e,t,n){"use strict";var i=n("9834"),r=n.n(i);r.a},c95f:function(e,t,n){},cf7e:function(e,t,n){},d07e:function(e,t,n){e.exports=n.p+"img/room_up.4220c4c8.svg"},d253:function(e,t,n){"use strict";var i=n("2937"),r=n.n(i);r.a},d360:function(e,t,n){},db4a:function(e,t,n){e.exports=n.p+"img/input_emoji_hover.8e0b79b1.svg"},ebe0:function(e,t,n){e.exports=n.p+"img/input_file_default.e4cca5aa.svg"},f1c9:function(e,t,n){e.exports=n.p+"img/input_file_hover.093bf56d.svg"},f50d:function(e,t,n){"use strict";var i=n("bbc4"),r=n.n(i);r.a},f76d:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:!!e.viewingRoomId,expression:"!!viewingRoomId"}],staticClass:"chat-room",class:{"full-screen":!e.showRoomList},style:{height:e.windowHeight+"px",width:e.windowWidth-e.roomListWidth+"px"}},[i("div",{staticClass:"room-title"},[i("div",{staticClass:"room-title-name"},[e._v("\n            "+e._s(e.viewingRoom.name)+"\n        ")]),e.viewingRoom.isChannel?i("div",{staticClass:"room-tools"},[i("Icon",{staticStyle:{cursor:"pointer"},attrs:{type:"md-settings"},on:{click:e.produceUrl}})],1):e._e()]),"FF"!==e.agentJudge?i("div",{ref:"records",staticClass:"timeline-list",class:{"cannot-scroll":e.isLoading},style:{height:e.windowHeight-e.editorHeight-40-50+"px"},on:{scroll:e.handleScroll,mousewheel:function(t){return t.stopPropagation(),e.handleMousewheel(t)}}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.showRoomUpBtn,expression:"showRoomUpBtn"}],staticClass:"go-to-up-btn",on:{click:e.scrollUp}},[i("img",{staticStyle:{width:"10px","vertical-align":"middle","margin-right":"5px"},attrs:{src:n("d07e"),alt:""}}),i("span",[e._v(e._s(e.showRoomUpBtn>99?"99+":e.showRoomUpBtn)+"条新消息")])]),e.isLoading?i("Spin",{staticClass:"loading-flag",attrs:{fix:""}},[i("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}})],1):e._e(),e._l(e.roomTimeLine,(function(t,n){return i("timeline-message",{key:n,ref:t.eventId,refInFor:!0,attrs:{eve:t,viewingRoom:e.viewingRoom},on:{imgOnloaded:e.imgOnloaded}})})),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showGotoBottomBtn,expression:"showGotoBottomBtn"}],staticClass:"go-to-bottom-btn",on:{click:e.scrollToBottom}},[i("img",{staticStyle:{width:"10px","vertical-align":"middle","margin-right":"5px"},attrs:{src:n("a0ad"),alt:""}}),e.viewingRoom.totlaunread>0?i("span",[e._v(e._s(e.viewingRoom.totlaunread>99?"99+":e.viewingRoom.totlaunread)+"条新消息")]):i("span",[e._v("回到底部")])])],2):i("div",{ref:"records",staticClass:"timeline-list ff",class:{"cannot-scroll":e.isLoading},on:{scroll:e.handleScroll,DOMMouseScroll:function(t){return t.stopPropagation(),e.handleMousewheel(t)}}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.showRoomUpBtn,expression:"showRoomUpBtn"}],staticClass:"go-to-up-btn",on:{click:e.scrollUp}},[i("img",{staticStyle:{width:"10px","vertical-align":"middle","margin-right":"5px"},attrs:{src:n("d07e"),alt:""}}),i("span",[e._v(e._s(e.showRoomUpBtn>99?"99+":e.showRoomUpBtn)+"条新消息")])]),e.isLoading?i("Spin",{staticClass:"loading-flag",attrs:{fix:""}},[i("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}})],1):e._e(),e._l(e.roomTimeLine,(function(t,n){return i("timeline-message",{key:n,ref:t.eventId,refInFor:!0,attrs:{eve:t,viewingRoom:e.viewingRoom},on:{imgOnloaded:e.imgOnloaded}})})),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showGotoBottomBtn,expression:"showGotoBottomBtn"}],staticClass:"go-to-bottom-btn",on:{click:e.scrollToBottom}},[i("img",{staticStyle:{width:"10px","vertical-align":"middle","margin-right":"5px"},attrs:{src:n("a0ad"),alt:""}}),e.viewingRoom.totlaunread>0?i("span",[e._v(e._s(e.viewingRoom.totlaunread>99?"99+":e.viewingRoom.totlaunread)+"条新消息")]):i("span",[e._v("回到底部")])])],2),i("div",{staticClass:"editor-drag-drop",style:{bottom:e.editorHeight+40-2+"px",left:e.roomListWidth-2+"px"},on:{mousedown:e.dragBegin}}),i("div",{staticClass:"msg-edit"},[i("editor",{ref:"editor",attrs:{members:e.viewingRoom.members,roomEntity:e.viewingRoom,emojiPickerDir:"up",myId:e.myinfo.userId},on:{handleImage:e.handleImage,handleVideo:e.handleVideo,handleOtherFile:e.handleOtherFile}})],1),i("Modal",{attrs:{title:e.confirmFile.title,closable:!1,"mask-closable":!1,transfer:!1,"class-name":"file-confirm-modal"},model:{value:e.confirmFile.show,callback:function(t){e.$set(e.confirmFile,"show",t)},expression:"confirmFile.show"}},[e.confirmFile.isImage?i("div",{staticClass:"file-confirm-content"},[i("img",{staticClass:"image",style:{"max-height":e.windowHeight-334+"px"},attrs:{src:e.confirmFile.url}})]):e.confirmFile.isVideo?i("div",{staticClass:"file-confirm-content"},[i("img",{staticClass:"image",attrs:{src:e.confirmFile.url}}),i("img",{staticClass:"icon",attrs:{src:e.icons.videoPop}})]):i("div",{staticClass:"file-confirm-content"},[i("img",{staticClass:"file-icon",attrs:{src:e.confirmFile.icon}}),i("div",{staticClass:"filename"},[e._v(e._s(e.confirmFile.name))]),i("div",{staticClass:"size"},[e._v(e._s(e.confirmFile.size))])]),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("Button",{staticClass:"action",attrs:{type:"default",size:"small"},on:{click:function(){return e.handleFileConfirmClick(!1)}}},[e._v("\n                取消\n            ")]),i("Button",{staticClass:"action",attrs:{type:"primary",size:"small"},on:{click:function(){return e.handleFileConfirmClick(!0)}}},[e._v("\n                发送\n            ")])],1)]),i("Modal",{attrs:{width:"60%"},model:{value:e.roomConfig.show,callback:function(t){e.$set(e.roomConfig,"show",t)},expression:"roomConfig.show"}},[i("p",{attrs:{slot:"header"},slot:"header"},[i("span",[e._v("频道链接")])]),i("div",[i("p",{staticStyle:{display:"inline-block","vertical-align":"middle","line-height":"32px",width:"calc(100% - 60px)"}},[e._v(e._s(e.roomJumpUrl))]),i("Button",{staticStyle:{float:"right","vertical-align":"middle"},on:{click:e.copyRoomJumpUrl}},[e._v("复制")])],1),i("div",{staticStyle:{"text-align":"left"},attrs:{slot:"footer"},slot:"footer"},[e._v("\n            用户在Web端可以通过该链接方便地加入频道，快来分享吧！\n        ")])])],1)},r=[],o=(n("1c01"),n("58b2"),n("8e6e"),n("7514"),n("bd86")),s=(n("f559"),n("6d67"),n("d25f"),n("75fc")),a=(n("7f7f"),n("456d"),n("ac6a"),n("f3e2"),n("7618")),c=(n("4f37"),n("28a5"),n("96cf"),n("3b8d")),l=n("d2ee"),u=n("e047"),d=n("2f62"),m=400,h=400,f=function(e,t,n,i){var r=1,o=1;return e>n&&(r=n/e*1),t>i&&(o=i/t*1),r>o?o:r},v=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=document.createElement("img"),e.next=3,new Promise((function(e){n.onerror=function(){e()},n.onload=function(){e({width:n.width,height:n.height})},n.src=window.URL.createObjectURL(t)}));case 3:return i=e.sent,n&&n.remove(),e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,o,s,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:m,i=a.length>2&&void 0!==a[2]?a[2]:h,r=document.createElement("canvas"),o=document.createElement("video"),e.next=6,new Promise((function(e){o.onerror=function(){e()},o.onloadeddata=function(){var t=f(o.videoWidth,o.videoHeight,n,i),s=Math.floor(o.videoWidth*t),a=Math.floor(o.videoHeight*t);r.width=s,r.height=a,r.getContext("2d").clearRect(0,0,s,a),r.getContext("2d").drawImage(o,0,0,s,a),window.URL.revokeObjectURL(o.src),r.toBlob((function(t){t&&e({blob:t,info:{mimetype:t.type,size:t.size,w:s,h:a},width:o.videoWidth,height:o.videoHeight,duration:o.duration}),e()}))},o.src=window.URL.createObjectURL(t)}));case 6:return s=e.sent,o&&o.remove(),r&&r.remove(),e.abrupt("return",s);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(e){return new Promise((function(t){var n=function(e){e.name="image.png",t(e)},i=new Image;i.onerror=onerror,i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height;var t=e.getContext("2d");t.drawImage(i,0,0,e.width,e.height),e.toBlob(n),e&&e.remove()},i.src=e}))},w={getCompressRatio:f,getImageInfo:v,getThumbVideo:g,getBlobFromBase64:p},b=n("2ef0"),y=n.n(b),O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"message"},["m.text"===e.eve.content.msgtype?n("text-msg",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e(),"m.image"===e.eve.content.msgtype?n("image-msg",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom},on:{imgOnloaded:e.imgOnloaded}}):e._e(),"m.video"===e.eve.content.msgtype?n("video-msg",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e(),"m.audio"===e.eve.content.msgtype?n("audio-msg",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e(),"m.room.member"===e.eve.type?n("member-ship",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e(),"m.room.name"===e.eve.type?n("room-name",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e(),"m.room.redaction"===e.eve.type?n("redact-msg",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e(),"m.room.power_levels"===e.eve.type&&e.eve.content.msgBody?n("power-levels",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e(),"m.location"===e.eve.content.msgtype?n("locate-msg",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e(),"m.file"===e.eve.content.msgtype?n("unknow-file-message",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e(),"m.alert"===e.eve.content.msgtype?n("alert-msg",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e(),"m.room.archive"===e.eve.type?n("archive-msg",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e(),"m.call.hangup"===e.eve.type?n("mobile-call",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e(),e.eve.content.msgType===e.Message.types.eventEncrypted||e.eve.content.msgType===e.Message.types.badEncrypted?n("encrypted-msg",{key:e.eve.eventId,attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}):e._e()],1)},R=[],E=n("a9e1"),I=(n("009c"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"event-item",class:{"my-message":e.eve.sender===e.myinfo.userId}},[i("user-header",{attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}),i("div",{staticClass:"event-content"},[i("div",{staticClass:"event-send-info"},[i("div",{staticClass:"sender-name"},[e._v("\n            "+e._s(e.findUserName(e.eve))+"\n        ")]),i("div",{staticClass:"send-time"},[e._v("\n            "+e._s(e.computeTime(e.eve))+"\n        ")])]),"Safari"!==e.agentJudge?i("div",{staticClass:"event-msgbody"},[i("img",{directives:[{name:"show",rawName:"v-show",value:!e.play,expression:"!play"}],staticClass:"thumbnail-image",style:{width:e.videoWidth+"px"},attrs:{src:e.getImgUrl(e.eve.content.info.thumbnail_url),alt:""},on:{click:e.handleClickImage}}),i("img",{directives:[{name:"show",rawName:"v-show",value:!e.play,expression:"!play"}],staticClass:"play-icon",attrs:{src:n("49f0"),alt:""},on:{click:e.playVideo}}),i("video",{directives:[{name:"show",rawName:"v-show",value:e.play,expression:"play"}],ref:"video",style:{width:e.videoWidth+"px",height:e.getVideoHeight},attrs:{src:e.getVideoUrl(e.eve.content.url),controls:"controls"}},[e._v("\n            您的浏览器不支持 video 标签。\n          ")])]):e._e(),"Safari"===e.agentJudge?i("div",{staticClass:"event-msgbody",staticStyle:{"user-select":"none",color:"#888888"}},[e._v("\n          video在Safari浏览器无法正常播放，建议使用Chrome浏览器查看\n        ")]):e._e()])],1)}),k=[],x=n("025e"),A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header"},[n("img",{class:{"user-avatar":!0,loaded:e.hasLoaded},attrs:{src:e.error?e.DEFAULT_AVATAR:e.getEventAvatar(e.eve),alt:""},on:{load:function(t){e.hasLoaded=!0},error:e.headerOnError}})])},j=[],M={name:"Header",props:["eve","viewingRoom"],data:function(){return{DEFAULT_AVATAR:n("1216"),hasLoaded:!1,error:!1}},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{headerOnError:function(){this.error=!0},getEventAvatar:function(e){var t=this.viewingRoom.members,n=t.find((function(t){return t.userId===e.sender}));return n&&n.avatarUrl?window.matrix.user.mxcTransfer(n.avatarUrl||""):this.DEFAULT_AVATAR}},computed:{}},T=M,C=n("2877"),D=Object(C["a"])(T,A,j,!1,null,"1a4d0056",null),U=D.exports;function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _={name:"VidwoMessage",props:["eve","viewingRoom"],data:function(){return{play:!1,DEFAULT_AVATAR:n("1216"),agentJudge:x["agentJudge"],hasLoaded:!1}},components:{"user-header":U},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{findUserName:function(e){return this.userList.get(e.sender).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")},getImgUrl:function(e){return e?window.matrix.user.mxcTransfer(e||""):""},handleClickImage:function(){},playVideo:function(){this.play=!0,this.$refs.video.play()},getVideoUrl:function(e){return window.matrix.user.mxcTransfer(e||"")}},computed:P({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]),{videoWidth:function(){var e=this.eve.content.info.thumbnail_info,t=e.w,n=.3*(this.windowWidth-241);return Math.min(t/3,n)},getVideoHeight:function(){var e=this.eve.content.info.thumbnail_info,t=e.h,n=e.w,i=this.videoWidth/n*t;return i+"px"}})},S=_,Y=(n("302e"),Object(C["a"])(S,I,k,!1,null,"363678b4",null)),N=Y.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item",class:{"my-message":e.eve.sender===e.myinfo.userId}},[n("user-header",{attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}),n("div",{staticClass:"event-content"},[n("div",{staticClass:"event-send-info"},[n("div",{staticClass:"sender-name"},[e._v("\n            "+e._s(e.findUserName(e.eve))+"\n        ")]),n("div",{staticClass:"send-time"},[e._v("\n            "+e._s(e.computeTime(e.eve))+"\n        ")])]),n("div",{staticClass:"event-msgbody"},[n("div",{staticClass:"play-icon",class:{playing:e.playing},on:{click:e.audioPlay}}),n("div",{staticClass:"time-bar",style:{width:10+e.duration/100+"px","max-width":50*(e.windowWidth-241)%NaN}}),n("div",{staticClass:"audio-time"},[e._v("\n            "+e._s(e.audioTime)+"\n          ")]),n("audio",{ref:"audioPlayer",staticClass:"audio-player",attrs:{controls:"controls",src:e.getAudioUrl(e.eve.content.url)},on:{ended:function(t){e.playing=!1}}})])])],1)},B=[];function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V={name:"AudioMessage",props:["eve","viewingRoom"],data:function(){return{playing:!1,DEFAULT_AVATAR:n("1216"),hasLoaded:!1}},components:{"user-header":U},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{findUserName:function(e){return this.userList.get(e.sender).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")},getAudioUrl:function(e){return window.matrix.user.mxcTransfer(e||"")+"&mp3=true"},audioPlay:function(){this.$refs.audioPlayer.play(),this.playing=!0}},computed:z({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]),{duration:function(){return this.eve.content.info.duration},audioTime:function(){var e=this.eve.content.info.duration,t=Math.floor(e/1e3)||"0",n=Math.floor(t/60)||"0";return t=Math.floor(t-60*n)||"00","".concat(n,"'").concat(t,'"')}}),watch:{playing:function(e){}}},W=V,Q=(n("7c18"),Object(C["a"])(W,H,B,!1,null,"713ce7c2",null)),$=Q.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item",class:{"my-message":e.eve.sender===e.myinfo.userId}},[n("user-header",{attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}),n("div",{staticClass:"event-content"},[n("div",{staticClass:"event-send-info"},[n("div",{staticClass:"sender-name"},[e._v("\n            "+e._s(e.findUserName(e.eve))+"\n        ")]),n("div",{staticClass:"send-time"},[e._v("\n            "+e._s(e.computeTime(e.eve))+"\n        ")])]),n("div",{staticClass:"event-msgbody"},[n("img",{style:{width:e.imgWidth+"px"},attrs:{src:e.getImgUrl(e.eve.content.url),alt:""},on:{click:function(t){e.showBig=!0},load:e.imgOnloaded}})]),e.showBig?n("div",{staticClass:"big-pic",on:{click:function(t){t.stopPropagation(),e.showBig=!1}}},[n("img",{staticStyle:{"max-height":"100%","max-width":"100%"},attrs:{src:e.getImgUrl(e.eve.content.url),alt:""}})]):e._e()])],1)},J=[];function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K={name:"ImageMessage",props:["eve","viewingRoom"],data:function(){return{DEFAULT_AVATAR:n("1216"),showBig:!1,hasLoaded:!1}},components:{"user-header":U},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{findUserName:function(e){return this.userList.get(e.sender).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")},getImgUrl:function(e){return e?window.matrix.user.mxcTransfer(e||""):""},handleClickImage:function(){},imgOnloaded:function(){this.$emit("imgOnloaded"),this.hasLoaded=!0}},computed:X({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]),{imgWidth:function(){var e=this.eve.content.info,t=e.w,n=.3*(this.windowWidth-241);return Math.min(t/3,n)},imgHeight:function(){var e=this.eve.content.info,t=e.h,n=e.w,i=this.imgWidth/n*t;return i+"px"}})},q=K,ee=(n("b91d"),Object(C["a"])(q,G,J,!1,null,"6f1d0b89",null)),te=ee.exports,ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item",class:{"my-message":e.eve.sender===e.myinfo.userId}},[n("user-header",{attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}),n("div",{staticClass:"event-content"},[n("div",{staticClass:"event-send-info"},[n("div",{staticClass:"sender-name"},[e._v("\n          "+e._s(e.findUserName(e.eve))+"\n      ")]),n("div",{staticClass:"send-time"},[e._v("\n          "+e._s(e.computeTime(e.eve))+"\n      ")])]),n("div",{staticClass:"event-msgbody"},[n("div",{ref:"text",domProps:{innerHTML:e._s(e.sanitizedText())}})])])],1)},ie=[],re=(n("a481"),n("4917"),n("fcf0")),oe=n.n(re);function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce={name:"TextMessage",props:["eve","viewingRoom"],data:function(){return{DEFAULT_AVATAR:n("1216"),hasLoaded:!1,error:!1}},components:{"user-header":U},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{findUserName:function(e){return this.userList.get(e.sender).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")},sanitizedText:function(){var e=/(https?:\/\/|finchat:\/\/|www\.)[-a-zA-Z0-9@:;%_+.~#?!&./=]{2,1024}/gi,t=function(t){return t.match(e)},n=t(this.eve.content.body)?this.highlightUrl(e):this.eve.content.body;return n=n.replace(/</g,"&lt;").replace(/>/g,"&gt;"),oe.a.unicodeToImage(n)},highlightUrl:function(e){return this.eve.content.body.replace(e,(function(e){var t=e;return t.startsWith("http")||t.startsWith("finchat")||(t="https://".concat(t)),'<a href="'.concat(t,'" target="_blank" class="message-url" style="color:#4285F4;cursor:pointer;word-break:break-all;text-decoration:underline">').concat(e,"</a>")}))}},computed:ae({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]))},le=ce,ue=Object(C["a"])(le,ne,ie,!1,null,"3149b7b6",null),de=ue.exports,me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item-container"},[n("div",{staticClass:"event-item"},["leave"===e.eve.content.membership&&e.eve.sender===e.eve.state_key?n("span",[e._v("\n        "+e._s(e.eve.sender===e.myinfo.userId?"你":'"'+e.findUserName(e.eve.sender)+'"')+"离开了房间\n      ")]):e._e(),"leave"===e.eve.content.membership&&e.eve.sender!==e.eve.state_key?n("span",[e._v("\n        "+e._s(e.eve.sender===e.myinfo.userId?"你":'"'+e.findUserName(e.eve.sender)+'"')+"将"+e._s(e.eve.state_key===e.myinfo.userId?"你":'"'+e.findUserName(e.eve.state_key)+'"')+"移出了房间\n      ")]):e._e(),"join"===e.eve.content.membership?n("span",[e._v("\n        "+e._s(e.eve.state_key===e.myinfo.userId?"你":'"'+e.findUserName(e.eve.state_key)+'"')+"加入了房间\n      ")]):e._e(),"invite"===e.eve.content.membership?n("span",[e._v("\n        "+e._s(e.eve.sender===e.myinfo.userId?"你":'"'+e.findUserName(e.eve.sender)+'"')+"邀请"+e._s(e.eve.state_key===e.myinfo.userId?"你":'"'+e.findUserName(e.eve.state_key)+'"')+"加入了房间\n      ")]):e._e()])])},he=[];function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ge={name:"MemberShipMessage",props:["eve","viewingRoom"],data:function(){return{DEFAULT_AVATAR:n("1216")}},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getEventAvatar:function(e){var t=this.viewingRoom.members,n=t.find((function(t){return t.userId===e.sender}));return n&&n.avatarUrl?window.matrix.user.mxcTransfer(n.avatarUrl||""):this.DEFAULT_AVATAR},findUserName:function(e){return this.userList.get(e).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")}},computed:ve({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]),{action:function(){var e="";switch(this.eve.content.membership){case"leave":e="离开";break;case"join":e="加入";break;default:break}return e}})},pe=ge,we=(n("7b61"),Object(C["a"])(pe,me,he,!1,null,"b4ee2600",null)),be=we.exports,ye=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item-container"},[n("div",{staticClass:"event-item"},[e._v("\n      "+e._s(e.redactPerson)+"撤回了一条消息\n      "),n("span")])])},Oe=[];function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ie={name:"RedactMessage",props:["eve","viewingRoom"],data:function(){return{}},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getEventAvatar:function(e){var t=this.viewingRoom.members,n=t.find((function(t){return t.userId===e.sender}));return n&&n.avatarUrl?window.matrix.user.mxcTransfer(n.avatarUrl||""):this.DEFAULT_AVATAR},findUserName:function(e){return this.userList.get(e.sender).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")}},computed:Ee({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]),{action:function(){var e="";switch(this.eve.content.membership){case"leave":e="离开";break;case"join":e="加入";break;default:break}return e},redactPerson:function(){return this.eve.sender===this.myinfo.userId?"你":this.findUserName(this.eve)}})},ke=Ie,xe=(n("3f94"),Object(C["a"])(ke,ye,Oe,!1,null,"a0e41a38",null)),Ae=xe.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item-container"},[n("div",{staticClass:"event-item"},[n("span",[e._v("\n      "+e._s(e.eve.sender===e.myinfo.userId?"你":'"'+e.findUserName(e.eve.sender)+'"')+'修改房间名称为"'+e._s(e.eve.content.name)+'"\n    ')])])])},Me=[];function Te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Te(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Te(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var De={name:"RoomRenameMessage",props:["eve","viewingRoom"],data:function(){return{}},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getEventAvatar:function(e){var t=this.viewingRoom.members,n=t.find((function(t){return t.userId===e.sender}));return n&&n.avatarUrl?window.matrix.user.mxcTransfer(n.avatarUrl||""):this.DEFAULT_AVATAR},findUserName:function(e){return this.userList.get(e).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")}},computed:Ce({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]),{action:function(){var e="";switch(this.eve.content.membership){case"leave":e="离开";break;case"join":e="加入";break;default:break}return e}})},Ue=De,Le=(n("0bf8"),Object(C["a"])(Ue,je,Me,!1,null,"6ba31a2c",null)),Pe=Le.exports,_e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item-container"},[n("div",{staticClass:"event-item"},[n("span",[e._v("\n        "+e._s(e.eve.content.msgBody)+"\n      ")])])])},Se=[];function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He={name:"PowerLevelsMessage",props:["eve","viewingRoom"],data:function(){return{}},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{findUserName:function(e){return this.userList.get(e)&&this.userList.get(e).displayName}},computed:Ne({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]),{getRoomManager:function(){var e=this,t="";return Object.keys(this.eve.content.users).forEach((function(n){100===e.eve.content.users[n]&&(t=n)})),t}})},Be=He,Fe=(n("8e92"),Object(C["a"])(Be,_e,Se,!1,null,"251bf0f4",null)),ze=Fe.exports,Ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item",class:{"my-message":e.eve.sender===e.myinfo.userId}},[n("user-header",{attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}),n("div",{staticClass:"event-content"},[n("div",{staticClass:"event-send-info"},[n("div",{staticClass:"sender-name"},[e._v("\n            "+e._s(e.findUserName(e.eve))+"\n        ")]),n("div",{staticClass:"send-time"},[e._v("\n            "+e._s(e.computeTime(e.eve))+"\n        ")])]),n("div",{staticClass:"event-msgbody",on:{click:e.openLocateUrl}},[e._m(0),n("div",{staticClass:"locate-info"},[n("div",{staticClass:"locate-name"},[e._v("\n              "+e._s(e.eve.content.info.name)+"\n            ")]),n("div",{staticClass:"locate-address"},[e._v("\n              "+e._s(e.eve.content.info.address)+"\n            ")])])])])],1)},We=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"locate-icon"},[i("img",{attrs:{src:n("7040"),alt:""}})])}];function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ge={name:"LocationMessage",props:["eve","viewingRoom"],data:function(){return{play:!1,DEFAULT_AVATAR:n("1216"),hasLoaded:!1}},components:{"user-header":U},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{findUserName:function(e){return this.userList.get(e.sender).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")},getImgUrl:function(e){return e?window.matrix.user.mxcTransfer(e||""):""},handleClickImage:function(){},playVideo:function(){this.play=!0,this.$refs.video.play()},getVideoUrl:function(e){return window.matrix.user.mxcTransfer(e||"")},openLocateUrl:function(){window.open("http://ditu.amap.com/regeo?lng=".concat(this.eve.content.info.longitude,"&lat=").concat(this.eve.content.info.latitude),"newwindow","height=".concat(.6*this.windowHeight,",\n      width=").concat(.6*this.windowWidth,",\n      top=").concat(.2*this.windowHeight,",\n      left=").concat(.2*this.windowWidth,",\n      toolbar=no,\n      menubar=no,\n      scrollbars=no,\n      resizable=no,\n      location=no,\n      status=no"))}},computed:$e({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]))},Je=Ge,Ze=(n("4b04"),Object(C["a"])(Je,Ve,We,!1,null,"7f5a8408",null)),Xe=Ze.exports,Ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item",class:{"my-message":e.eve.sender===e.myinfo.userId}},[n("user-header",{attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}),n("div",{staticClass:"event-content"},[n("div",{staticClass:"event-send-info"},[n("div",{staticClass:"sender-name"},[e._v("\n            "+e._s(e.findUserName(e.eve))+"\n        ")]),n("div",{staticClass:"send-time"},[e._v("\n            "+e._s(e.computeTime(e.eve))+"\n        ")])]),n("div",{staticClass:"event-msgbody",on:{click:e.openLocateUrl}},[n("div",{staticClass:"locate-icon"},[n("img",{attrs:{src:e.findFileImg(),alt:""}})]),n("div",{staticClass:"locate-info"},[n("div",{staticClass:"locate-name"},[e._v("\n              "+e._s(e.eve.content.body)+"\n            ")]),n("div",{staticClass:"locate-address"},[e._v("\n              "+e._s(e.eve.content.info.size>1048576?new Number(100*e.eve.content.info.size/1024/1024/100).toFixed(2):Math.round(100*e.eve.content.info.size/1024/100))+"\n              "+e._s(e.eve.content.info.size>1048576?"MB":"KB")+"\n            ")])])])])],1)},qe=[],et="",tt={pdf:"".concat(et,"static/assets/icon-file/ico_pdf.svg"),word:"".concat(et,"static/assets/icon-file/ico_doc_docx.svg"),excel:"".concat(et,"static/assets/icon-file/ico_xls_xlsx.svg"),powerpoint:"".concat(et,"static/assets/icon-file/ico_ppt_pptx.svg"),doc:"".concat(et,"static/assets/icon-file/ico_doc_docx.svg"),xls:"".concat(et,"static/assets/icon-file/ico_xls_xlsx.svg"),ppt:"".concat(et,"static/assets/icon-file/ico_ppt_pptx.svg"),key:"".concat(et,"static/assets/icon-file/ico_key.svg"),keynote:"".concat(et,"static/assets/icon-file/ico_key.svg"),archive:"".concat(et,"static/assets/icon-file/ico_rar_zip.svg"),archive7z:"".concat(et,"static/assets/icon-file/ico_7z.svg"),txt:"".concat(et,"static/assets/icon-file/ico_txt.svg"),file:"".concat(et,"static/assets/icon-file/ico_other.svg"),other:"".concat(et,"static/assets/icon-file/ico_other.svg"),address:"".concat(et,"static/assets/icon-media/ico_address.svg"),image:"".concat(et,"static/assets/icon-media/ico_img.svg"),url:"".concat(et,"static/assets/icon-media/ico_link.svg"),video:"".concat(et,"static/assets/icon-media/ico_video.svg"),audio:"".concat(et,"static/assets/icon-media/ico_voice.svg"),messageLoading:"".concat(et,"static/assets/icon-status/room_send_loading.gif"),messageError:"".concat(et,"static/assets/icon-status/room_send_error.svg"),messageCancel:"".concat(et,"static/assets/icon-status/room_send_stop.svg"),videoLoading:"".concat(et,"static/assets/icon-status/room_video_loaidng.svg"),videoPlay:"".concat(et,"static/assets/icon-status/room_video_play.svg"),videoPop:"".concat(et,"static/assets/icon-status/send_pop_video.svg"),imageError:"".concat(et,"static/assets/icon-status/room_image_error.svg"),folder:"".concat(et,"static/assets/ico_folder.svg"),download:"".concat(et,"static/assets/ic_download.svg"),share:"".concat(et,"static/assets/ic_share.svg"),more:"".concat(et,"static/assets/ic_more.svg"),error:"".concat(et,"static/assets/ic_error.svg"),success:"".concat(et,"static/assets/ic_success.svg"),up:".static/assets/ico_up.svg",down:"".concat(et,"static/assets/ico_down.svg"),add:"".concat(et,"static/assets/ic_add.svg")};tt[l["Message"].types.file]="".concat(et,"static/assets/icon-file/ico_file.svg"),tt[l["Message"].types.image]="".concat(et,"static/assets/icon-media/ico_img.svg"),tt[l["Message"].types.url]="".concat(et,"static/assets/icon-media/ico_link.svg"),tt[l["Message"].types.video]="".concat(et,"static/assets/icon-media/ico_video.svg"),tt[l["Message"].types.audio]="".concat(et,"static/assets/icon-media/ico_voice.svg"),tt[l["Message"].types.txt]="".concat(et,"static/assets/icon-file/ico_txt.svg");var nt=function(e){var t="";switch(e){case"pdf":t="pdf";break;case"doc":case"docx":t="word";break;case"xls":case"xlsx":t="excel";break;case"ppt":case"pptx":t="powerpoint";break;case"key":t="keynote";break;case"txt":t="txt";break;case"zip":case"rar":t="archive";break;case"7z":t="archive7z";break;case"mp3":case"amr":t="audio";break;case"dmg":t="file";break;case"js":case"css":case"html":t="code";break;default:t=e;break}return tt[t]||tt.file};function it(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?it(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):it(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ot={name:"FileMessage",props:["eve","viewingRoom"],data:function(){return{play:!1,downloadElement:null,DEFAULT_AVATAR:n("1216"),DEFAULT_FILE:n("10aa"),hasLoaded:!1}},components:{"user-header":U},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{findUserName:function(e){return this.userList.get(e.sender).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")},getImgUrl:function(e){return e?window.matrix.user.mxcTransfer(e||""):""},handleClickImage:function(){},playVideo:function(){this.play=!0,this.$refs.video.play()},getVideoUrl:function(e){return window.matrix.user.mxcTransfer(e||"")},openLocateUrl:function(){this.downloadElement=this.downloadElement||document.createElement("a"),this.downloadElement.target="_blank",this.downloadElement.href=window.matrix.user.mxcTransfer(this.eve.content.url||""),this.downloadElement.download=this.eve.content.body,this.downloadElement.click()},findFileImg:function(){var e="",t=this.eve.content.body.split(".");t[t.length-1]&&(e=t[t.length-1].toLowerCase());var n=nt(e);return n||this.DEFAULT_FILE}},computed:rt({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]))},st=ot,at=(n("9eec"),Object(C["a"])(st,Ke,qe,!1,null,"57d40720",null)),ct=at.exports,lt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item",class:{"my-message":e.eve.sender===e.myinfo.userId}},[n("user-header",{attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}),n("div",{staticClass:"event-content"},[n("div",{staticClass:"event-send-info"},[n("div",{staticClass:"sender-name"},[e._v("\n            "+e._s(e.findUserName(e.eve))+"\n        ")]),n("div",{staticClass:"send-time"},[e._v("\n            "+e._s(e.computeTime(e.eve))+"\n        ")])]),n("div",{staticClass:"event-msgbody"},[n("div",{ref:"text",domProps:{innerHTML:e._s(e.sanitizedText())}})])])],1)},ut=[];function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ht={name:"AlertMessage",props:["eve","viewingRoom"],data:function(){return{DEFAULT_AVATAR:n("1216"),hasLoaded:!1}},components:{"user-header":U},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{findUserName:function(e){return this.userList.get(e.sender).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")},sanitizedText:function(){var e=/(https?:\/\/|finchat:\/\/|www\.)[-a-zA-Z0-9@:;%_+.~#?!&./=]{2,1024}/gi,t=function(t){return t.match(e)},n=t(this.eve.content.body)?this.highlightUrl(e):this.eve.content.body;return oe.a.unicodeToImage(n)},highlightUrl:function(e){return this.eve.content.body.replace(e,(function(e){var t=e;return t.startsWith("http")||t.startsWith("finchat")||(t="https://".concat(t)),'<a href="'.concat(t,'" target="_blank" class="message-url" style="color:#4285F4;cursor:pointer;word-break:break-all;text-decoration:underline">').concat(e,"</a>")}))}},computed:mt({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]))},ft=ht,vt=(n("c70d"),Object(C["a"])(ft,lt,ut,!1,null,"00916572",null)),gt=vt.exports,pt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item-container"},[n("div",{staticClass:"event-item"},[e._v("\n      "+e._s(e.redactPerson)+e._s(e.eve.content.archive?"归档":"恢复")+"了此频道\n      "),n("span")])])},wt=[];function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ot={name:"ArchiveMessage",props:["eve","viewingRoom"],data:function(){return{}},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getEventAvatar:function(e){var t=this.viewingRoom.members,n=t.find((function(t){return t.userId===e.sender}));return n&&n.avatarUrl?window.matrix.user.mxcTransfer(n.avatarUrl||""):this.DEFAULT_AVATAR},findUserName:function(e){return this.userList.get(e.sender).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")}},computed:yt({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]),{action:function(){var e="";switch(this.eve.content.membership){case"leave":e="离开";break;case"join":e="加入";break;default:break}return e},redactPerson:function(){return this.eve.sender===this.myinfo.userId?"你":this.findUserName(this.eve)}})},Rt=Ot,Et=(n("1c79"),Object(C["a"])(Rt,pt,wt,!1,null,"0205f050",null)),It=Et.exports,kt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item-container"},[n("div",{staticClass:"event-item"},[e._v("\n      "+e._s(e.eve.content.msgBody)+"\n      "),n("span")])])},xt=[];function At(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?At(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):At(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Mt={name:"MobileCall",props:["eve","viewingRoom"],data:function(){return{}},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getEventAvatar:function(e){var t=this.viewingRoom.members,n=t.find((function(t){return t.userId===e.sender}));return n&&n.avatarUrl?window.matrix.user.mxcTransfer(n.avatarUrl||""):this.DEFAULT_AVATAR},findUserName:function(e){return this.userList.get(e.sender).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")}},computed:jt({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]),{action:function(){var e="";switch(this.eve.content.membership){case"leave":e="离开";break;case"join":e="加入";break;default:break}return e},redactPerson:function(){return this.eve.sender===this.myinfo.userId?"你":this.findUserName(this.eve)}})},Tt=Mt,Ct=(n("1677"),Object(C["a"])(Tt,kt,xt,!1,null,"b0314fe4",null)),Dt=Ct.exports,Ut=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-item",class:{"my-message":e.eve.sender===e.myinfo.userId}},[n("user-header",{attrs:{eve:e.eve,viewingRoom:e.viewingRoom}}),n("div",{staticClass:"event-content"},[n("div",{staticClass:"event-send-info"},[n("div",{staticClass:"sender-name"},[e._v("\n            "+e._s(e.findUserName(e.eve))+"\n        ")]),n("div",{staticClass:"send-time"},[e._v("\n            "+e._s(e.computeTime(e.eve))+"\n        ")])]),e._m(0)])],1)},Lt=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-msgbody"},[n("div",[e._v("[无法解析的加密消息]")])])}];function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var St={name:"Encrypted",props:["eve","viewingRoom"],data:function(){return{DEFAULT_AVATAR:n("1216"),hasLoaded:!1,error:!1}},components:{"user-header":U},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{findUserName:function(e){return this.userList.get(e.sender).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")},sanitizedText:function(){var e=/(https?:\/\/|finchat:\/\/|www\.)[-a-zA-Z0-9@:;%_+.~#?!&./=]{2,1024}/gi,t=function(t){return t.match(e)},n=t(this.eve.content.body)?this.highlightUrl(e):this.eve.content.body;return oe.a.unicodeToImage(n)},highlightUrl:function(e){return this.eve.content.body.replace(e,(function(e){var t=e;return t.startsWith("http")||t.startsWith("finchat")||(t="https://".concat(t)),'<a href="'.concat(t,'" target="_blank" class="message-url" style="color:#4285F4;cursor:pointer;word-break:break-all;text-decoration:underline">').concat(e,"</a>")}))}},computed:_t({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]))},Yt=St,Nt=Object(C["a"])(Yt,Ut,Lt,!1,null,"120cb114",null),Ht=Nt.exports;function Bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bt(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zt={name:"Message",props:["eve","viewingRoom"],components:{"video-msg":N,"audio-msg":$,"image-msg":te,"text-msg":de,"member-ship":be,"redact-msg":Ae,"room-name":Pe,"power-levels":ze,"locate-msg":Xe,"unknow-file-message":ct,"alert-msg":gt,"archive-msg":It,"mobile-call":Dt,"encrypted-msg":Ht},data:function(){return{DEFAULT_AVATAR:n("1216"),Message:l["Message"]}},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getEventAvatar:function(e){var t=this.viewingRoom.members,n=t.find((function(t){return t.userId===e.sender}));return n&&n.avatarUrl?window.matrix.user.mxcTransfer(n.avatarUrl||""):this.DEFAULT_AVATAR},findUserName:function(e){return this.userList.get(e.sender).displayName},computeTime:function(e){return this.$moment(new Date).format("YYYYMMDD")>this.$moment(e.time).format("YYYYMMDD")?this.$moment(e.time).format("YYYY年MM月DD日 HH:mm"):this.$moment(e.time).format("HH:mm")},imgOnloaded:function(){this.$emit("imgOnloaded")}},computed:Ft({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable"]))},Vt=zt,Wt=(n("f50d"),Object(C["a"])(Vt,O,R,!1,null,null,null)),Qt=Wt.exports,$t=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ediotr-new"},[n("div",{staticClass:"editor-tools"},[n("div",{staticClass:"tool-item",on:{click:e.handleOpenEmoji}},[n("img",{attrs:{src:"static/assets/input_emoji_default.svg"}})]),n("div",{staticClass:"tool-item",on:{click:e.handleOpenFile}},[n("input",{ref:"editorFiles",attrs:{type:"file"},on:{change:e.handleFileChose}}),n("img",{attrs:{src:"static/assets/input_file_default.svg"}})])]),e.ifShowAtList?n("div",{staticClass:"at-list"},e._l(e.filtedAtList,(function(t){return n("div",{key:t.userId,staticClass:"at-item",class:{hover:e.curHoverUserId===t.userId},on:{mouseenter:function(n){return e.handleAtItemHover(t)},click:function(t){return e.handleAtItemClick(t)}}},[n("img",{staticStyle:{width:"30px",height:"30px","vertical-align":"middle","border-radius":"15px","margin-right":"10px",display:"inline-block"},attrs:{src:t.imgerror?e.DEFAULT_AVATAR:t.avatarUrl||e.DEFAULT_AVATAR,alt:""},on:{error:function(n){return e.imgOnError(t)}}}),e._v("\n      "+e._s(t.name)+"\n      "),e.curHoverUserId===t.userId?n("div",{attrs:{id:"hoveredAtBlock-"+(e.roomEntity.roomId&&e.roomEntity.roomId.replace(/!|:|\./g,""))}}):e._e()])})),0):e._e(),e.ifShowEmojiPicker?n("epicker",{ref:"epicker",attrs:{id:"epicker-"+(e.roomEntity.roomId&&this.roomEntity.roomId.replace(/!|:|\./g,"")),emojiPickerDir:e.emojiPickerDir},on:{insertEmoji:e.insertEmoji,close:e.handleCloseEmoji}}):e._e(),n("div",{ref:"editor",staticClass:"editor",class:{"editor-draging":e.editorDraging},style:{flex:"1 0 "+e.editorHeight+"px"},attrs:{id:"editor-"+(e.roomEntity.roomId&&this.roomEntity.roomId.replace(/!|:|\./g,"")),contenteditable:e.roomEntity&&e.roomEntity.isBan?"false":"true",placeholder:e.roomEntity&&e.roomEntity.isBan?"房间已禁言":"请输入内容"},on:{compositionstart:e.compositionstart,compositionend:e.compositionend,input:e.handleEditorChange}}),n("Modal",{attrs:{title:e.confirmFile.title,closable:!1,"mask-closable":!1,transfer:!1,"class-name":"file-confirm-modal"},model:{value:e.confirmFile.show,callback:function(t){e.$set(e.confirmFile,"show",t)},expression:"confirmFile.show"}},[e.confirmFile.isImage?n("div",{staticClass:"file-confirm-content"},[n("img",{staticClass:"image",attrs:{src:e.confirmFile.url}})]):e.confirmFile.isVideo?n("div",{staticClass:"file-confirm-content"},[n("img",{staticClass:"image",attrs:{src:e.confirmFile.url}}),n("img",{staticClass:"icon",attrs:{src:e.icons.videoPop}})]):n("div",{staticClass:"file-confirm-content"},[n("img",{staticClass:"file-icon",attrs:{src:e.confirmFile.icon}}),n("div",{staticClass:"filename"},[e._v(e._s(e.confirmFile.name))]),n("div",{staticClass:"size"},[e._v(e._s(e.confirmFile.size))])]),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{staticClass:"action",attrs:{type:"default",size:"small"},on:{click:function(){return e.handleFileConfirmClick(!1)}}},[e._v("\n        取消\n      ")]),n("Button",{staticClass:"action",attrs:{type:"primary",size:"small"},on:{click:function(){return e.handleFileConfirmClick(!0)}}},[e._v("\n        发送\n      ")])],1)])],1)},Gt=[],Jt=(n("57e7"),n("32bd")),Zt=n.n(Jt),Xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"emoji-picker-wrapper",class:e.className},[n("div",{staticClass:"emoji-panel"},e._l(e.emojis[e.tag],(function(t){return n("div",{key:t,staticClass:"panel-item",on:{click:function(n){return e.handleEmojiClick(t)}}},[n("div",{domProps:{innerHTML:e._s(e.unicodeToImage(t))}})])})),0),n("div",{staticClass:"group-selecter"},[n("div",{staticClass:"group-item",class:{selected:"people"===e.tag},on:{click:function(t){return e.handleGroupSelection("people")}}},[n("img",{attrs:{src:"static/assets/emoticon/people_default.svg"}})]),n("div",{staticClass:"group-item",class:{selected:"object"===e.tag},on:{click:function(t){return e.handleGroupSelection("object")}}},[n("img",{attrs:{src:"static/assets/emoticon/object_default.svg"}})]),n("div",{staticClass:"group-item",class:{selected:"place"===e.tag},on:{click:function(t){return e.handleGroupSelection("place")}}},[n("img",{attrs:{src:"static/assets/emoticon/place_default.svg"}})]),n("div",{staticClass:"group-item",class:{selected:"symbol"===e.tag},on:{click:function(t){return e.handleGroupSelection("symbol")}}},[n("img",{attrs:{src:"static/assets/emoticon/symbol_default.svg"}})]),n("div",{staticClass:"group-item",class:{selected:"nature"===e.tag},on:{click:function(t){return e.handleGroupSelection("nature")}}},[n("img",{attrs:{src:"static/assets/emoticon/nature_default.svg"}})])])])},Kt=[],qt={props:{emojiPickerDir:{type:String,default:"up"}},computed:{className:function(){return"".concat(this.emojiPickerDir," ").concat(this.theme)}},data:function(){return{emojis:{people:["😥","😄","😃","😀","😊","😉","😍","😘","😚","😗","😙","😜","😝","😛","😳","😁","😔","😌","😒","😞","😣","😢","😂","😭","😪","😰","😅","😓","😩","😫","😨","😱","😠","😡","😤","😖","😆","😋","😷","😎","😴","😵","😲","😟","😦","😧","😈","👿","😮","😬","😐","😕","😯","😶","😇","😏","😑","👲","👳","👮","👷","💂","👶","👦","👧","👨","👩","👴","👵","👱","👼","👸","😺","😸","😻","😽","😼","🙀","😿","😹","😾","👹","👺","🙈","🙉","🙊","💀","👽","💩","🔥","✨","🌟","💫","💥","💢","💦","💧","💤","💨","👂","👀","👃","👅","👄","👍","👎","👌","👊","✊","✌","👋","✋","👐","👆","👇","👉","👈","🙌","🙏","☝","👏","💪","🚶","🏃","💃","👫","👪","👬","👭","💏","💑","👯","🙆","🙅","💁","🙋","💆","💇","💅","👰","🙎","🙍","🙇","🎩","👑","👒","👟","👞","👡","👠","👢","👕","👔","👚","👗","🎽","👖","👘","👙","💼","👜","👝","👛","👓","🎀","🌂","💄","💛","💙","💜","💚","❤","💔","💗","💓","💕","💖","💞","💘","💌","💋","💍","💎","👤","👥","💬","👣","💭"],object:["🎍","💝","🎎","🎒","🎓","🎏","🎆","🎇","🎐","🎑","🎃","👻","🎅","🎄","🎁","🎋","🎉","🎊","🎈","🎌","🔮","🎥","📷","📹","📼","💿","📀","💽","💾","💻","📱","☎","📞","📟","📠","📡","📺","📻","🔊","🔉","🔈","🔇","🔔","🔕","📢","📣","⏳","⌛","⏰","⌚","🔓","🔒","🔏","🔐","🔑","🔎","💡","🔦","🔆","🔅","🔌","🔋","🔍","🛁","🛀","🚿","🚽","🔧","🔩","🔨","🚪","🚬","💣","🔫","🔪","💊","💉","💰","💴","💵","💷","💶","💳","💸","📲","📧","📥","📤","✉","📩","📨","📯","📫","📪","📬","📭","📮","📦","📝","📄","📃","📑","📊","📈","📉","📜","📋","📅","📆","📇","📁","📂","✂","📌","📎","✒","✏","📏","📐","📕","📗","📘","📙","📓","📔","📒","📚","📖","🔖","📛","🔬","🔭","📰","🎨","🎬","🎤","🎧","🎼","🎵","🎶","🎹","🎻","🎺","🎷","🎸","👾","🎮","🃏","🎴","🀄","🎲","🎯","🏈","🏀","⚽","⚾","🎾","🎱","🏉","🎳","⛳","🚵","🚴","🏁","🏇","🏆","🎿","🏂","🏊","🏄","🎣","☕","🍵","🍶","🍼","🍺","🍻","🍸","🍹","🍷","🍴","🍕","🍔","🍟","🍗","🍖","🍝","🍛","🍤","🍱","🍣","🍥","🍙","🍘","🍚","🍜","🍲","🍢","🍡","🍳","🍞","🍩","🍮","🍦","🍨","🍧","🎂","🍰","🍪","🍫","🍬","🍭","🍯","🍎","🍏","🍊","🍋","🍒","🍇","🍉","🍓","🍑","🍈","🍌","🍐","🍍","🍠","🍆","🍅","🌽"],place:["🏠","🏡","🏫","🏢","🏣","🏥","🏦","🏪","🏩","🏨","💒","⛪","🏬","🏤","🌇","🌆","🏯","🏰","⛺","🏭","🗼","🗾","🗻","🌄","🌅","🌃","🗽","🌉","🎠","🎡","⛲","🎢","🚢","⛵","🚤","🚣","⚓","🚀","✈️","💺","🚁","🚂","🚊","🚉","🚞","🚆","🚄","🚅","🚈","🚇","🚝","🚋","🚃","🚎","🚌","🚍","🚙","🚘","🚗","🚕","🚖","🚛","🚚","🚨","🚓","🚔","🚒","🚑","🚐","🚲","🚡","🚟","🚠","🚜","💈","🚏","🎫","🚦","🚥","⚠","🚧","🔰","⛽","🏮","🎰","♨","🗿","🎪","🎭","📍","🚩","🇯🇵","🇰🇷","🇩🇪","🇨🇳","🇺🇸","🇫🇷","🇪🇸","🇮🇹","🇷🇺"],symbol:["🔢","🔣","⬆","⬇","⬅","➡","🔠","🔡","🔤","↗️","↖️","↘️","↙️","↔️","↕️","🔄","◀️","▶️","🔼","🔽","↩️","↪️","ℹ️","⏪","⏩","⏫","⏬","⤵️","⤴️","🆗","🔀","🔁","🔂","🆕","🆙","🆒","🆓","🆖","📶","🎦","🈁","🈯️","🈳","🈵","🈴","🈲","🉐","🈹","🈺","🈶","🈚️","🚻","🚹","🚺","🚼","🚾","🚰","🚮","🅿️","♿","🚭","🈷️","🈸","🈂","Ⓜ️","🛂","🛄","🛅","🛃","🉑","㊙️","㊗️","🆑","🆘","🆔","🚫","🔞","📵","🚯","🚱","🚳","🚷","🚸","⛔","✳","❇","❎","✅","✴","💟","🆚","📳","📴","🅰️","🅱️","🆎","🅾️","💠","➿","♻","♈","♉","♊","♋","♌","♍","♎","♏","♐","♑","♒","♓","⛎","🔯","🏧","💹","💲","💱","™","❌","‼","⁉","❗","❓","❕","❔","⭕","🔝","🔚","🔙","🔛","🔜","🔃","🕛","🕧","🕐","🕜","🕑","🕝","🕒","🕞","🕓","🕟","🕔","🕠","🕕","🕖","🕗","🕘","🕙","🕚","🕡","🕢","🕣","🕤","🕥","🕦","✖","➕","➖","➗","♠","♥️","♣","♦","💮","💯","✔","☑","🔘","🔗","➰","〰","〽","🔱","◼","◻","◾","◽","▪","▫","🔺","🔲","🔳","⚫","⚪","🔴","🔵","🔻","⬜","⬛","🔶","🔷","🔸","🔹"],nature:["🐶","🐺","🐱","🐭","🐹","🐰","🐸","🐯","🐨","🐻","🐷","🐽","🐮","🐗","🐵","🐒","🐴","🐑","🐘","🐼","🐧","🐦","🐤","🐥","🐣","🐔","🐍","🐢","🐛","🐝","🐜","🐞","🐌","🐙","🐚","🐠","🐟","🐬","🐳","🐋","🐄","🐏","🐀","🐃","🐅","🐇","🐉","🐎","🐐","🐓","🐕","🐖","🐁","🐂","🐲","🐡","🐊","🐫","🐪","🐆","🐈","🐩","🐾","💐","🌸","🌷","🍀","🌹","🌻","🌺","🍁","🍃","🍂","🌿","🌾","🍄","🌵","🌴","🌲","🌳","🌰","🌱","🌼","🌐","🌞","🌝","🌚","🌑","🌒","🌓","🌔","🌕","🌖","🌗","🌘","🌜","🌛","🌙","🌍","🌎","🌏","🌋","🌌","🌠","⭐","☀","⛅","☁","⚡","☔","❄","⛄","🌀","🌁","🌈","🌊"]},tag:"people",theme:"default"}},methods:{unicodeToImage:function(e){return oe.a.unicodeToImage(e)},handleGroupSelection:function(e){this.tag=e},handleEmojiClick:function(e){this.$emit("insertEmoji",e)}},created:function(){},mounted:function(){},beforeDestroy:function(){}},en=qt,tn=(n("0667"),Object(C["a"])(en,Xt,Kt,!1,null,null,null)),nn=tn.exports,rn=(n("20d6"),n("9865"),n("386d"),n("3b2b"),!1),on=10485760,sn={data:function(){return{editorContent:"",ifShowAtList:!1,ifShowEmojiPicker:!1,curHoverUserId:"",compositionInputing:!1,atIntervalId:"",lastInputData:"",atFilter:"",savedRange:null,enableChatRecord:rn,uploadQueue:[],confirmFile:{},lastTypingTime:0}},methods:{handleUpload:function(e){var t;return(t=this.uploadQueue).unshift.apply(t,Object(s["a"])(e)),!0},handleUploadQueue:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1],i=on||104857600,console.log(t),console.log(t.size),!(t.size>i)){e.next=8;break}return this.$Message.error("仅限发送不超过".concat(i/1048576,"M的文件")),this.uploadQueue.pop(),e.abrupt("return");case 8:n?this.handleOtherFileModel(t):t.type.startsWith("image")?this.handleImageModel(t):this.handleOtherFileModel(t);case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleImageModel:function(e){var t=window.URL.createObjectURL(e);this.confirmFile={show:!0,isImage:!0,title:"发送到:".concat(this.roomEntity.name.length>16?"".concat(this.roomEntity.name.slice(0,16),"..."):this.roomEntity.name),file:e,name:e.name,url:t}},handleFileConfirmClick:function(e){if(this.confirmFile.show=!1,this.uploadQueue.length){var t=this.uploadQueue.pop();if(!t||!t.size)return void this.$Message.error("无效文件");e?t.type.startsWith("image")?this.$emit("handleImage",t):t.type.startsWith("video")?this.$emit("handleVideo",t):this.$emit("handleOtherFile",t):this.confirmFile.url&&window.URL.revokeObjectURL(this.confirmFile.url)}},handleOtherFileModel:function(e){console.log("handleOtherFileModel",e);var t="";e.name.split(".")[1]&&(t=e.name.split(".")[1].toLowerCase());var n=nt(t);this.confirmFile={show:!0,title:"发送到:".concat(this.roomEntity.name.length>16?"".concat(this.roomEntity.name.slice(0,16),"..."):this.roomEntity.name),icon:n,type:"file",file:e,name:e.name,size:e.size>1048576?"".concat(parseInt(e.size/1048576,10)," MB"):"".concat(parseInt(e.size/1024,10)," KB")}},insertEmoji:function(e){this.isCursorInEditor()&&this.savedRange?this.restoreCursorPos():this.focus(),setTimeout((function(){document.execCommand("insertHTML",!1,oe.a.unicodeToImage(e))}),10),this.ifShowEmojiPicker=!1},restoreCursorPos:function(){if(this.savedRange){var e=window.getSelection();e.removeAllRanges(),e.addRange(this.savedRange)}},saveCursorPos:function(){var e=window.getSelection();e.getRangeAt&&e.rangeCount&&(this.savedRange=e.getRangeAt(0))},handleOpenEmoji:function(){var e=this;this.$refs.editor.focus(),this.roomEntity&&this.roomEntity.isBan?this.$Message.error("房间已禁言"):(this.saveCursorPos(),setTimeout((function(){e.ifShowEmojiPicker=!0}),10))},handleScreenshot:function(){this.roomEntity&&this.roomEntity.isBan?this.$Message.error("房间已禁言"):window.finstation.sendMessage("SCREENSHOT")},handleOpenChatRecord:function(){window.finstation&&(window.finstation.sendMessage(void 0,"OPEN_CHAT_RECORD",{roomName:this.roomEntity.name,roomId:this.roomEntity.roomId},"webview"),window.finstation.addons.launch({name:"聊天记录-".concat(this.roomEntity.name),id:"com.finogeeks.personal.chatRecord",disableNavigationBar:!0,single:!0,url:VIEW_CHAT_RECORD,width:700,height:620,frame:!1,powerLevel:5,type:"window",meta:{roomName:this.roomEntity.name,roomId:this.roomEntity.roomId}}))},handleCloseEmoji:function(){this.restoreCursorPos(),this.ifShowEmojiPicker=!1},focus:function(){if(this.roomEntity.roomId){var e=window.getSelection();e.selectAllChildren(document.getElementById("editor-".concat(this.roomEntity.roomId.replace(/!|:|\./g,"")))),e.collapseToEnd()}},handleAtItemHover:function(e){this.curHoverUserId=e.userId},isCursorInEditor:function(){console.log("isCursorInEditor");var e=document.getElementById("editor-".concat(this.roomEntity.roomId.replace(/!|:|\./g,""))),t=getSelection().anchorNode;return(!t.parentElement.attributes.contenteditable||"false"!==t.parentElement.attributes.contenteditable.nodeValue)&&e.contains(t)},getCursorStr:function(){var e=getSelection(),t=e.anchorNode&&e.anchorNode.textContent||"",n=e.getRangeAt(0);return{before:t&&t[n.startOffset-1]||null,after:t&&t[n.startOffset]||null}},findAtFilterStr:function(){var e=getSelection(),t=e.anchorNode&&e.anchorNode.textContent||"";if(!t)return null;var n=e.getRangeAt(0),i=n.endOffset,r=t.lastIndexOf("@",i-1);return-1===r?null:t.substring(r+1,i)},handleKeyEvent:function(e){var t=this;if(8===e.keyCode){var n=document.getElementById("editor-".concat(this.roomEntity.roomId.replace(/!|:|\./g,""))),i=n.innerHTML;"<br>"===i&&(n.innerHTML="")}if(this.confirmFile.show&&("Escape"===e.key&&(e.preventDefault(),this.handleFileConfirmClick(!1),this.focus()),"Enter"===e.key))return e.preventDefault(),this.handleFileConfirmClick(!0),void this.focus();if(this.ifShowAtList){if("Backspace"===e.key&&"@"===this.getCursorStr().before&&this.closeAtList(),"Escape"===e.key&&(e.preventDefault(),this.closeAtList()),"Enter"===e.key&&this.curHoverUserId)return e.preventDefault(),void this.handleInsertAtBlock();if("ArrowUp"===e.key){e.preventDefault();var r=this.filtedAtList.findIndex((function(e){return e.userId===t.curHoverUserId}));r>0&&(this.curHoverUserId=this.filtedAtList[r-1].userId,document.getElementById("hoveredAtBlock-".concat(this.roomEntity.roomId.replace(/!|:|\./g,""))).scrollIntoView(!1))}if("ArrowDown"===e.key){e.preventDefault();var o=this.filtedAtList.findIndex((function(e){return e.userId===t.curHoverUserId}));o<this.filtedAtList.length-1&&this.filtedAtList.length>0&&(this.curHoverUserId=this.filtedAtList[o+1].userId,document.getElementById("hoveredAtBlock-".concat(this.roomEntity.roomId.replace(/!|:|\./g,""))).scrollIntoView())}}if("Enter"===e.key){if(console.log("e.key === 'Enter'"),console.log(this.canSend),e.preventDefault(),!this.canSend)return;if(e.ctrlKey||e.metaKey||e.altKey)return void document.execCommand("insertHTML",!1,"<br></br>");if(e.shiftKey||this.compositionInputing)return;this.sendTextMessage()}(e.ctrlKey||e.metaKey)&&(66!==e.keyCode&&98!==e.keyCode&&73!==e.keyCode&&105!==e.keyCode&&85!==e.keyCode&&117!==e.keyCode||e.preventDefault())},handlePaste:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("handlePaste"),console.log(this.isCursorInEditor()),!this.isCursorInEditor()){e.next=24;break}if(t&&t.preventDefault(),n="",i=t.clipboardData,console.log(i),console.log(i.types),r=i.items[i.items.length-1],console.log(r),!r||!r.getAsFile()){e.next=15;break}o=r.getAsFile(),this.handleUpload([o]),e.next=24;break;case 15:if(!(i.types.indexOf("text/plain")>-1||i.types.indexOf("text/html")>-1)){e.next=23;break}if(n=i.getData("text/plain"),!(n.length>5e3)){e.next=20;break}return this.$Message.error("消息过长，无法粘贴"),e.abrupt("return");case 20:document.execCommand("insertHTML",!1,oe.a.unicodeToImage(n.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,"<br>").replace(/\n/g,"<br>").replace(/ /g,"&nbsp;"))),e.next=24;break;case 23:i.types.indexOf("Files")>-1&&(s=i.files[0],this.handleUpload([s]));case 24:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleContextMenu:function(){var e=this;window.finstation&&window.finstation.buildContextMenu([{label:"剪切",role:"cut"},{label:"复制",role:"copy"},{label:"粘贴",click:function(){return e.handlePaste()}}])},originContent:function(){if(!this.roomEntity.roomId)return"";var e=document.getElementById("editor-".concat(this.roomEntity.roomId.replace(/!|:|\./g,""))),t=e.innerHTML;return t},parseContent:function(){var e=document.getElementById("editor-".concat(this.roomEntity.roomId.replace(/!|:|\./g,""))),t=e.innerHTML;if(t=t.replace(/<span>/g,"").replace(/<\/span>/g,"").replace(/<br>/g,"\n").replace(/&nbsp;/g," "),!(t.length>6e3)){var n=t.match(/<img class="emojione" .+?>/g);n&&n.length&&n.forEach((function(e){var n=e.match(/alt="(.+?)"/);t=t.replace(e,n[1])}));var i=[],r=[],o=/<label data-user-id="(.+?)" .+?>(.+?)<\/label>/g.exec(t);while(o)i.push(o[1]),t=t.replace(o[0],o[2]),r.push({start:o.index,end:o.index+o[2].length,type:"@",val:o[1]}),o=/<label data-user-id="(.+?)" .+?>(.+?)<\/label>/g.exec(t);return t=t.replace(/&lt;/g,"<").replace(/&gt;/g,">").trim(),i.length?{msgtype:"m.alert",body:t,idlist:i,signals:r}:{msgtype:"m.text",body:t}}this.$Message.error("消息过长，无法发送")},showAtList:function(){this.ifShowAtList=!0,this.curHoverUserId=this.filtedAtList[0].userId,this.atIntervalId||this.startAtInterval()},closeAtList:function(){this.ifShowAtList=!1,this.curHoverUserId="",clearInterval(this.atIntervalId),this.atIntervalId=null},startAtInterval:function(){var e=this;this.atIntervalId=setInterval((function(){e.isCursorInEditor()?(e.ifShowAtList=!0,e.atFilter=e.findAtFilterStr()):e.ifShowAtList=!1}),500)},handleEditorChange:function(e){if("@"===e.data){if(this.roomEntity.isDirect)return;var t=window.getSelection(),n=t.focusNode;this.focuseNode=n,this.showAtList()}this.handleUserTyping()},handleOpenFile:function(){this.roomEntity&&this.roomEntity.isBan?this.$Message.error("房间已禁言"):this.roomEntity&&this.roomEntity.isQQRoom&&!this.isQQServerWorking?this.$Message.error("QQ服务不可用"):this.$refs.editorFiles.click()},handleComposition:function(e){this.compositionInputing=e},replaceEmojiWithImg:function(){var e=this;if(this.roomEntity.roomId){var t=document.getElementById("editor-".concat(this.roomEntity.roomId.replace(/!|:|\./g,""))),n=new MutationObserver((function(e){e.forEach((function(e){if("characterData"===e.type&&e.target.data&&e.target.data.match(/(\ud83c[\udf00-\udfff])|(\ud83d[\udc00-\ude4f\ude80-\udeff])|[\u2600-\u2B55]/g)){var t=getSelection().anchorNode,n=document.createElement("span");if(!e.oldValue)return n.innerHTML="",void e.target.parentNode.replaceChild(n,e.target);n.innerHTML=oe.a.unicodeToImage(t.textContent.replace(/</g,"&lt;").replace(/>/g,"&gt;")),e.target.parentNode.replaceChild(n,e.target);var i=[].findIndex.call(n.childNodes,(function(e){return"IMG"===e.tagName}));-1===i&&(i=n.childNodes.length-1),getSelection().setBaseAndExtent(n,i+1,n,i+1)}}))})),i={characterData:!0,characterDataOldValue:!0,subtree:!0};n.observe(t,i)}else setTimeout((function(){e.replaceEmojiWithImg()}),1e3)},insertAtBlock:function(e){console.log("isCursorInEditor: ",this.isCursorInEditor());var t=getSelection();console.log(t);var n=document.createElement("span");n.innerHTML=e;var i=t.anchorNode&&t.anchorNode.textContent||"";console.log("content: ",i);var r=t.getRangeAt(0);console.log("range: ",r);var o=r.endOffset;console.log("endIndex: ",o);var s=i.lastIndexOf("@",o-1);o=s+1,console.log("atIndex, endIndex : ",s,o),s>-1&&r.setStart(t.anchorNode,s),s>-1&&r.setEnd(t.anchorNode,o),console.log("range: ",r),r.deleteContents(),r.insertNode(n.lastChild),r.collapse(),document.execCommand("insertText",!1," "),this.closeAtList()},blob2FileInfo:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={name:t.name,path:t.path,size:t.size,type:t.type},!t.type.startsWith("image")){e.next=8;break}return e.next=4,w.getImageInfo(t);case 4:i=e.sent,n.width=i.width,n.height=i.height,t.base64Contents&&(n.base64Contents=t.base64Contents);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),handleClickCloseEmoji:function(e){if(this.ifShowEmojiPicker){var t=document.getElementById("epicker-".concat(this.roomEntity.roomId.replace(/!|:|\./g,"")));t&&!t.contains(e.target)&&this.ifShowEmojiPicker&&(this.ifShowEmojiPicker=!1)}},handleUserTyping:function(){}},watch:{filtedAtList:function(){this.curHoverUserId=this.filtedAtList[0]&&this.filtedAtList[0].userId||null},uploadQueue:function(e){if(e.length){var t=e[e.length-1];this.handleUploadQueue(t)}}},mounted:function(){var e=this;window.document.addEventListener("keydown",this.handleKeyEvent),window.document.addEventListener("paste",this.handlePaste),window.document.addEventListener("mousedown",this.handleClickCloseEmoji),setTimeout((function(){e.replaceEmojiWithImg(),e.focus()}),10)},beforeDestroy:function(){window.document.removeEventListener("keydown",this.handleKeyEvent),window.document.removeEventListener("paste",this.handlePaste),window.document.removeEventListener("mousedown",this.handleClickCloseEmoji),clearInterval(this.atIntervalId)}};function an(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function cn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?an(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):an(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ln={name:"ediotr",components:{epicker:nn},mixins:[sn],props:{roomEntity:{type:Object,required:!0,default:{roomId:""}},members:{type:Array,required:!0,default:function(){return[]}},emojiPickerDir:{type:String,default:"up"},myId:{type:String,default:""}},data:function(){return{focuseNode:null,canSend:!0,DEFAULT_AVATAR:n("1216"),agentJudge:x["agentJudge"]}},methods:{imgOnError:function(e){e.imgerror=!0},compositionstart:function(e){console.log("compositionstart"),this.canSend=!1,console.log(this.canSend)},compositionend:function(e){var t=this;console.log("compositionend"),"Safari"===x["agentJudge"]?setTimeout((function(){t.canSend=!0,console.log(t.canSend)}),150):(this.canSend=!0,console.log(this.canSend))},mxcTransfer:function(e){return window.matrix.user.mxcTransfer(e.avatarUrl||"")},handleAtItemClick:function(e){e.preventDefault(),e.stopPropagation(),this.$refs.editor.focus();var t=document.createRange(),n=this.focuseNode;console.log(this.focuseNode),t.selectNodeContents(n);var i=window.getSelection();i.removeAllRanges(),i.addRange(t),this.handleInsertAtBlock()},handleInsertAtBlock:function(){var e=this,t=this.filtedAtList.find((function(t){return t.userId===e.curHoverUserId})).name,n='<label data-user-id="'.concat(this.curHoverUserId,'" style="color: #4285f4" contenteditable="false">@').concat(t,"</label>");this.insertAtBlock(n)},handleFileChose:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.handleUpload(this.$refs.editorFiles.files),setTimeout((function(){t.$refs.editorFiles.value=""}),1e3);case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleSendFile:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.blob2FileInfo(t);case 2:n=e.sent,Zt.a.proxy.sendFile(this.roomEntity.roomId,n),setTimeout((function(){i.$refs.editorFiles.value=""}),1e3);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),sendTextMessage:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.isCursorInEditor()){e.next=2;break}return e.abrupt("return");case 2:if(t=this.parseContent(),t.body){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,window.matrix.mxClient.sendMessage(this.roomEntity.roomId,t);case 7:e.sent,n=document.getElementById("editor-".concat(this.roomEntity.roomId.replace(/!|:|\./g,""))),n.innerText="",this.focus();case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),replaceText:function(e){var t=document.getElementById("editor-".concat(this.roomEntity.roomId.replace(/!|:|\./g,"")));t.innerHTML=e;var n=document.createRange(),i=t.childNodes,r=i.length>0?i[i.length-1]:t;n.selectNodeContents(r),n.collapse(!1);var o=window.getSelection();if(o.removeAllRanges(),o.addRange(n),"@"===e.slice(-1)){this.showAtList();var s=window.getSelection(),a=s.focusNode;this.focuseNode=a}}},computed:cn({},Object(d["b"])(["editorHeight","editorDraging"]),{filtedAtList:function(){var e=this,t=Object(s["a"])(this.members),n=t.filter((function(t){return t.avatarUrl=t.avatarUrl?e.mxcTransfer(t):"",t.name.indexOf(e.atFilter||"")>-1&&t.userId!==e.myId&&"join"===t.membership||"@all"===t.userId}));return n.unshift({avatarUrl:"static/assets/room_avatar_all.svg",displayName:"所有人",name:"所有人",rawDisplayName:"所有人",userId:"@all"}),n}}),created:function(){},mounted:function(){},beforeDestroy:function(){},beforeUpdate:function(){},watch:{"roomEntity.roomId":function(e){this.closeAtList()}}},un=ln,dn=(n("5a71"),n("d253"),Object(C["a"])(un,$t,Gt,!1,null,"751e0f43",null)),mn=dn.exports,hn=n("7823"),fn=(n("78ce"),n("0cd8"),n("a745")),vn=n.n(fn);function gn(e){if(vn()(e))return e}var pn=n("5d73"),wn=n.n(pn),bn=n("c8bb"),yn=n.n(bn);function On(e,t){if(yn()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=wn()(e);!(i=(s=a.next()).done);i=!0)if(n.push(s.value),t&&n.length===t)break}catch(err){r=!0,o=err}finally{try{i||null==a["return"]||a["return"]()}finally{if(r)throw o}}return n}}function Rn(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function En(e,t){return gn(e)||On(e,t)||Rn()}var In=n("d225"),kn=n("b0b4");function xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function An(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xn(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var jn=function(){function e(){var t=this;Object(In["a"])(this,e),this.userId=null,this.namespace=null,window.onFileCacheMessage=function(e){if(e.callBackId&&t.callBackIds[e.callBackId]){var n=An({},e);delete n.callBackId,"get"===n.type&&"function"===typeof t.callBackIds[e.callBackId]?(t.callBackIds[e.callBackId](n),delete t.callBackIds[e.callBackId]):"set"===n.type&&(n.error||isNaN(n.percent)?(t.callBackIds[e.callBackId].onEnd(n),delete t.callBackIds[e.callBackId]):t.callBackIds[e.callBackId].onProgress(n,t.callBackIds[e.callBackId].cancel))}},this.callBackIds={}}return Object(kn["a"])(e,[{key:"initNameSpace",value:function(e){this.userId=e,this.namespace=e.replace(/@|:|\./gi,"")}},{key:"get",value:function(e){var t=this;return"object"===Object(a["a"])(window.finstation)&&this.namespace?new Promise((function(n,i){var r=Date.now();window.finstation.getCache({key:e,callBackId:r}),t.callBackIds[r]=function(e){e.error?i(e.error):n(e)}})):Promise.reject()}},{key:"set",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};return"object"===Object(a["a"])(window.finstation)&&this.namespace?new Promise((function(r,o){var s=Date.now(),a=window.finstation.setCache(An({key:e},t,{customHeaders:{"X-Consumer-Custom-ID":n.userId},callBackId:s})),c=null;c=a&&"function"===typeof a.cancel?function(){a.cancel(),o("cancel")}:function(){},n.callBackIds[s]={cancel:c,onProgress:i,onEnd:function(e){e.error?o(e.error):r(e)}}})):Promise.reject()}}]),e}(),Mn=new jn,Tn=function(){function e(){Object(In["a"])(this,e),this.caches={},this.ignore={},this.$matrix=null,this.pendingUsers=[],this.isPendingUser=!1,this.updatingUsers=[],this.isUpdatingUser=!1}return Object(kn["a"])(e,[{key:"setMatrix",value:function(e){this.$matrix=e}},{key:"excludeCharacter",value:function(e){return e.replace(/@|:|\.|!/gi,"")}},{key:"getUserAvatar",value:function(e,t){return this.ignore[e]>=3?"":(!this.caches[e]&&t&&this.pendingUsers.push([e,t]),this.processPendingUser(),this.caches[e]||t)}},{key:"updateUserAvatar",value:function(e,t){t&&this.caches[e]&&(window.URL.revokeObjectURL(this.caches[e]),this.caches[e]=null),this.updatingUsers.push([e,t]),this.processUpdatingUser()}},{key:"processPendingUser",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n,i,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.pendingUsers.length&&!this.isPendingUser){e.next=2;break}return e.abrupt("return");case 2:this.isPendingUser=!0,t=[].concat(this.pendingUsers),n=0;case 5:if(!(n<t.length)){e.next=18;break}if(i=En(t[n],2),r=i[0],o=i[1],e.prev=7,this.caches[r]){e.next=11;break}return e.next=11,this.getUserAvatarAsync(r,o);case 11:e.next=15;break;case 13:e.prev=13,e.t0=e["catch"](7);case 15:n+=1,e.next=5;break;case 18:this.pendingUsers=[],this.isPendingUser=!1;case 20:case"end":return e.stop()}}),e,this,[[7,13]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"processUpdatingUser",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n,i,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.updatingUsers.length&&!this.isUpdatingUser){e.next=2;break}return e.abrupt("return");case 2:this.isUpdatingUser=!0,t=[].concat(this.updatingUsers),n=0;case 5:if(!(n<t.length)){e.next=19;break}if(i=En(t[n],2),r=i[0],o=i[1],this.ignore[r]&&!(this.ignore[r]<3)){e.next=16;break}return e.prev=8,e.next=11,this.updateUserAvatarAsync(r,o);case 11:u["a"].emit("AVATAR_UPDATED_".concat(r),this.caches[r]),e.next=16;break;case 14:e.prev=14,e.t0=e["catch"](8);case 16:n+=1,e.next=5;break;case 19:this.updatingUsers=[],this.isUpdatingUser=!1;case 21:case"end":return e.stop()}}),e,this,[[8,14]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getUserAvatarAsync",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n){var i,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.ignore[t]>=3)){e.next=2;break}return e.abrupt("return","");case 2:return i=this.excludeCharacter(t),e.prev=3,e.next=6,this.getCache(i,n);case 6:return r=e.sent,this.caches[t]=r,e.abrupt("return",r);case 11:return e.prev=11,e.t0=e["catch"](3),o=this.ignore[t],this.ignore[t]=o?o+1:1,e.abrupt("return","");case 16:case"end":return e.stop()}}),e,this,[[3,11]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"updateUserAvatarAsync",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n){var i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=this.excludeCharacter(t),e.next=3,this.setCache(i,n);case 3:r=e.sent,this.caches[t]&&window.URL.revokeObjectURL(this.caches[t]),this.caches[t]=r;case 6:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"getCache",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Mn.get(t);case 3:return i=e.sent,e.abrupt("return",this.covertFileToBlob("file://".concat(i.path)));case 7:if(e.prev=7,e.t0=e["catch"](0),!n){e.next=11;break}return e.abrupt("return",this.setCache(t,n));case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"setCache",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n){var i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i="".concat(Mn.namespace,"/Avatar/").concat(t),e.prev=1,e.next=4,Mn.set(t,{url:this.$matrix?this.$matrix.mxcTransfer(n):n,fileName:i});case 4:return r=e.sent,e.abrupt("return",this.covertFileToBlob("file://".concat(r.path)));case 8:throw e.prev=8,e.t0=e["catch"](1),e.t0;case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"covertFileToBlob",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new Request(t),e.next=3,fetch(n);case 3:return i=e.sent,e.next=6,i.blob();case 6:return r=e.sent,e.abrupt("return",URL.createObjectURL(r));case 8:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),Cn=(new Tn,{userId:"@all",name:"所有人",rawDisplayName:"所有人"});function Dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dn(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ln=!1,Pn={width:180,height:34,enableAvatar:!0},_n={width:338,height:45,enableAvatar:!1},Sn={data:function(){return{suggestions:[],suggestionOption:Pn,suggestionSelectedBot:void 0,INPUT_EMOJI_DEFAULT:n("704f"),INPUT_EMOJI_DEFAULT_HOVER:n("db4a"),INPUT_FILE_DEFAULT:n("ebe0"),INPUT_FILE_DEFAULT_HOVER:n("f1c9")}},computed:Un({},Object(d["b"])({roles:function(e){return e.userInfo&&e.userInfo.roles}}),{disabledEditor:function(){return!this.viewingRoom.isDirect&&(this.isBanAll||!!this.viewingRoom.isArchiveChannel)},disabledEditorMessage:function(){return this.viewingRoom.isArchiveChannel?"频道已被归档":"全员禁言中"},tools:function(){var e=this,t=[{name:"EMOTICON",icon:this.INPUT_EMOJI_DEFAULT,iconHover:this.INPUT_EMOJI_DEFAULT_HOVER,callback:function(t){return e.handleEditorToolClick(t)}},{name:"FILE",icon:this.INPUT_FILE_DEFAULT,iconHover:this.INPUT_FILE_DEFAULT_HOVER,callback:function(t){return e.handleEditorToolClick(t)}}];!this.viewingRoom.isBot&&this.viewingRoom.isDirect&&this.hasVoiceCall&&(t.push({name:"AUDIO_CALL",callback:function(){return e.handleCall("voice")}}),t.push({name:"VIDEO_CALL",callback:function(){return e.handleCall("video")}}));var n=this.roles?this.roles.reduce((function(e,t){return"super"===e.name||"super"===t.name?"super":"fin_supervisor"===e.name||"fin_supervisor"===t.name?"fin_supervisor":"trader"===e.name||"trader"===t.name?"trader":"fin_worker"}),""):"";return"trader"===n&&t.push({name:"BIM",callback:function(){window.finstation&&window.finstation.addons.launch({name:"BIM",id:"com.finogeeks.personal.bim",disableNavigationBar:!0,url:"".concat(VIEW_BIM,"?room_id=").concat(e.roomId),width:500,height:436,powerLevel:5,type:"window"})}}),Ln&&t.push({name:"RECORD",callback:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!window.finstation){t.next=8;break}if(n=window.onGetRoom({roomId:e.roomId}),1!==n.isEncryped){t.next=5;break}return e.$Message.warning("端到端加密信息不支持搜索"),t.abrupt("return");case 5:window.finstation.sendMessage(void 0,"OPEN_CHAT_RECORD",{roomName:e.rawRoom.name,roomId:e.roomId},"webview"),window.finstation.addons.launch({name:"聊天记录-".concat(e.rawRoom.name),id:"com.finogeeks.personal.chatRecord",disableNavigationBar:!0,single:!0,url:VIEW_CHAT_RECORD,width:700,height:620,frame:!1,powerLevel:5,type:"window",meta:{roomName:e.rawRoom.name,roomId:e.roomId}});case 8:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()}),this.viewingRoom.isServiceRoom&&(t.push({name:"EVALUATE",callback:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var n,i,r,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.rawRoom.currentState.getStateEvents("m.room.topic",""),i=JSON.parse(n.event.content.topic).custService,t.prev=2,r=e.$store.state.authInfo,t.next=6,e.$http({method:"GET",url:"/api/v1/swan/bot/dispatch/".concat(i.orderId,"/brief?jwt=").concat(r.api_token,"&access_token=").concat(r.access_token)});case 6:if(o=t.sent,s=o.data,s.orderStatus,!0!==i.isClosed){t.next=12;break}return e.$Message.error("该状态无法发起评价"),t.abrupt("return");case 12:return t.next=14,e.$http({method:"PUT",url:"/api/v1/swan/bot/dispatch/evalmsg?jwt=".concat(r.api_token,"&access_token=").concat(r.access_token),data:{orderId:i.orderId,dispatchPattern:"B",appType:"STAFF",staffId:i.staffId,roomId:e.rawRoom.roomId}});case 14:return t.next=16,e.$http({method:"POST",url:"/api/v1/swan/bot/dispatch/close?jwt=".concat(r.api_token,"&access_token=").concat(r.access_token),data:{orderId:i.orderId,pattern:"B",retailId:i.retailId,staffId:i.staffId,roomId:e.rawRoom.roomId}});case 16:t.next=22;break;case 18:t.prev=18,t.t0=t["catch"](2),e.$Message.error("发起评价失败"),console.log(t.t0);case 22:case"end":return t.stop()}}),t,null,[[2,18]])})));function n(){return t.apply(this,arguments)}return n}()}),t.push({name:"TRANSFER",callback:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var n,i,r,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.rawRoom.currentState.getStateEvents("m.room.topic",""),i=JSON.parse(n.event.content.topic).custService,r=e.$store.state.authInfo,t.next=5,e.$http({method:"GET",url:"/api/v1/swan/bot/dispatch/".concat(i.orderId,"/brief?jwt=").concat(r.api_token,"&access_token=").concat(r.access_token)});case 5:if(o=t.sent,s=o.data,s.orderStatus,!0!==i.isClosed){t.next=11;break}return e.$Message.error("该状态无法发起转单"),t.abrupt("return");case 11:u["a"].once("SERVICE_TRANSFER",(function(t,n){e.$store.commit("RESET_MODAL"),"success"===n.data.msg?e.$Message.success("转单成功"):"error"===n.data.msg&&e.$Message.error("转单不成功")})),e.$store.commit("CREATE_MODAL",{type:"transfer",meta:{createType:"transfer",custService:i,authInfo:r,callback:{type:"event",event:"SERVICE_TRANSFER",id:"service-transfer",from:"service-transfer"}}});case 13:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()})),t},textValue:function(){return this.changeValue.text},commandMode:function(){return this.isBot(this.suggestionSelectedBot)&&/^(@)([^@])+(\s)$/.test(this.textValue)}}),methods:{getRole:function(){},handleEditorToolClick:function(e){if(this.isBanAll)this.$Message.error("全员禁言中");else if(this.viewingRoom.isArchiveChannel)this.$Message.error("频道已被归档");else switch(e){case"CAPTURE":this.handleCapture();break;default:break}},handleCapture:y.a.throttle((function(){"object"===Object(a["a"])(window.finstation)&&(window.finstation.sendMessage("GET_WIN_EVN","CAPTURE"),window.finstation.sendMessage("SCREENSHOT"))}),2e3,{leading:!0}),handleCall:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$matrix.createCall(this.roomId,t);case 2:n=e.sent,n.status||this.$Message.warning(n.data.error||"拨打失败");case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getFilteredMembers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];return t=e?this.peerMembers.filter((function(t){var n=t.userId.split(":"),i=n[0].substring(1);return t.rawDisplayName.indexOf(e)>-1||i.indexOf(e)>-1})):[Cn].concat(this.peerMembers),t},handleSearchMention:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"@",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!this.viewingRoom.isDirect&&"@"===t){var i=this.getFilteredMembers(n);if(i.length)return i.map((function(t){if("@all"===t.userId)return{id:t.userId,name:t.rawDisplayName.trim(),icon:"static/assets/room_avatar_all.svg"};var n=e.$matrix.matrixClient.getUser(t.userId);return{id:t.userId,name:n.displayName.trim()||t.rawDisplayName.trim()||t.userId,icon:e.$matrix.mxcTransfer(n.avatarUrl)||e.$matrix.mxcTransfer(t.avatar)}}))}return[]},handleEditorEvent:function(e){var t=e.type,n=e.payload;switch(t){case"send":this.handleSend(n);break;case"upload":this.handleUpload(n);break;case"change":this.changeValue=n,n.text||(this.suggestions=[]),this.editingMsg=n.text;break;default:console.log(t),console.log(n);break}this.timeLineFix=!1},handleEditorTrigger:function(e){var t=e.trigger,n=e.term;(n||t)&&(this.suggestionOption=Pn,this.suggestions=this.handleSearchMention(t,n))},handleEditorSuggestionClick:function(e){e.index;var t=e.id,n=e.value,i="".concat(this.textValue).concat(n," ");this.commandMode?this.$refs.editor.appendText("".concat(n," ")):this.insertSignal(t,n),this.isBot(t)&&(this.suggestionSelectedBot=t),this.suggestionSelectedBot&&this.fetchCommands(this.suggestionSelectedBot,i)},handleEditorTextClick:function(e){console.log(e)},insertSignal:function(e,t){this.$refs.editor.insertSignal("@",e,t),this.suggestions=[]},fetchCommands:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n){var i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.suggestions=[],i=n.split(" ").filter((function(e){return!!e})),i.shift(),e.next=5,this.$fcFinbot.fetchCommands(t,i);case 5:r=e.sent,r&&r.length?(this.suggestionOption=_n,this.suggestions=r.map((function(e){return Un({id:"".concat(e.name,"-").concat(Date.now())},e)})),this.suggestionSelectedBot=t):this.suggestionSelectedBot=void 0;case 7:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}(),isBot:function(e){return/^(.+)(-bot)(.+)$/.test(e)}},watch:{suggestions:function(e){this.$refs.editor.handleIgnoreEnter(!!e.length)}}};function Yn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yn(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Hn=window.matrix,Bn=5,Fn=0,zn=!0,Vn={props:["viewingRoomId","isConsultMode"],mixins:[Sn],components:{"timeline-message":Qt,editor:mn},created:function(){},data:function(){return{isLoading:!1,recordsScrollHeight:0,recoresScrollTop:0,drafts:[],confirmFile:{},uploadQueue:[],timeLineFix:!1,showGotoBottomBtn:!1,agentJudge:x["agentJudge"],oldEditingMsg:"",editingMsg:"",showRoomUpBtn:!1,roomConfig:{show:!1},roomJumpUrl:"",mouseMoveY:0,timer:null}},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:u["a"].addListener("TIMELINE_UPDATE",(function(e,t){t===n.viewingRoomId&&(n.timeLineFix||n.$nextTick((function(){n.scrollToBottom({forceRecipt:!0})})))})),u["a"].addListener("ROOM_UPDATE",(function(e){e.isArchiveChannel&&n.$emit("quitRoom"),"leave"===e.membership&&n.$emit("quitRoom")})),t=JSON.parse(window.localStorage.getItem(hn["b"])),this.$fcNetdisk.init("",t.userId,t.jwt,t.access_token);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{dragBegin:function(){console.log("dragBegin"),this.$store.commit("setEditorDraging",!0),document.addEventListener("mousemove",this.documentMove),document.addEventListener("mouseup",this.dragEnd)},dragEnd:function(){console.log("dragEnd"),this.$store.commit("setEditorDraging",!1),document.removeEventListener("mousemove",this.documentMove),document.removeEventListener("mouseup",this.dragEnd)},documentMove:function(e){var t=this;0!==e.movementY&&(this.mouseMoveY+=e.movementY,this.timer||(this.timer=setTimeout((function(){t.$store.commit("setEditorHeight",t.editorHeight-t.mouseMoveY),clearTimeout(t.timer),t.timer=null,t.mouseMoveY=0}),16)))},copyRoomJumpUrl:function(){var e=document.createElement("input");document.body.appendChild(e),e.setAttribute("value",this.roomJumpUrl),e.setAttribute("readonly","readonly"),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.$Message.success("复制成功！")},joinRoomTest:function(){E["a"].joinRoom(this.chatRoom)},produceUrl:function(){var e=window.location.href.split("?")[0],t="".concat(e,"?chatroom=").concat(this.viewingRoom.roomId);this.roomJumpUrl=t,this.roomConfig.show=!0},computeUnread:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(this.viewingRoom.unread>9)){e.next=6;break}return this.showRoomUpBtn=this.viewingRoom.unread,e.next=4,window.matrix.viewingRoom.getTimelineMsg(this.viewingRoomId,this.roomTimeLine[this.roomTimeLine.length-1].eventId,"BACKWORDS",this.viewingRoom.unread);case 4:t=e.sent,this.$store.commit("loadMoreTimeline",{message:t,roomId:this.viewingRoomId});case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),scrollUp:function(){var e=this.$refs.records,t=(Math.ceil(e.scrollTop),Math.ceil(e.scrollHeight),Math.ceil(e.clientHeight),this.roomTimeLine[this.roomTimeLine.length-this.showRoomUpBtn]),n=this.$refs[t.eventId];e.scrollTop=n[0].$el.offsetTop,this.showRoomUpBtn=!1},imgOnloaded:function(){this.timeLineFix||this.scrollToBottom()},scrollToBottom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.forceRecipt,n=this.$refs.records,i=(Math.ceil(n.scrollTop),Math.ceil(n.scrollHeight)),r=Math.ceil(n.clientHeight);n.scrollTop=i-r,this.timeLineFix=!1,(this.viewingRoom.totlaunread>0||t)&&this.handleSendReceipt()},clearEditingMsg:function(){this.$refs.editor&&this.$refs.editor.replaceText(this.viewingRoom.roomEditingMsg)},saveEditingMsg:function(){this.viewingRoom.roomEditingMsg=this.$refs.editor.originContent(),this.$store.commit("updateRoomList",null)},saveOldEditMsg:function(){this.oldEditingMsg=this.$refs.editor.originContent()},loadMore:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,window.matrix.viewingRoom.getTimelineMsg(this.viewingRoomId,this.roomTimeLine[0].eventId);case 2:t=e.sent,this.$store.commit("loadMoreTimeline",{message:t,roomId:this.viewingRoomId});case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),sendMessage:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n){var i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.roomId,r=t.message,e.next=3,window.matrix.mxClient.sendMessage(i,r);case 3:e.sent;case 4:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}(),handleMousewheel:function(){var e=this.$refs.records,t=e.scrollTop,n=e.scrollHeight,i=e.clientHeight;this.showRoomUpBtn=!1,this.timeLineFix=n>t+i,e&&!this.isLoading&&(t=Math.ceil(e.scrollTop),t<Bn?this.handleMoreTimeline():t+i!==n||this.viewingRoom.totlaunread>0&&this.handleSendReceipt())},handleScroll:function(){var e=this.$refs.records,t=e.scrollTop,n=e.scrollHeight,i=e.clientHeight;this.showGotoBottomBtn=n>t+i},handleMoreTimeline:Object(b["debounce"])(function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.isLoading&&!this.hasOldTimelineTable[this.viewingRoomId]){e.next=2;break}return e.abrupt("return");case 2:return this.isLoading=!0,this.recordsScrollHeight=this.$refs.records.scrollHeight,this.$refs.records.scrollTop=0,e.next=7,window.matrix.viewingRoom.getTimelineMsg(this.viewingRoomId,this.roomTimeLine[0].eventId);case 7:if(n=e.sent,0!==n.length){e.next=12;break}return this.$store.commit("setOldTimelineTable",{roomId:this.viewingRoomId,hasOldTimeline:!0}),this.isLoading=!1,e.abrupt("return");case 12:this.$store.commit("loadMoreTimeline",{message:n,roomId:this.viewingRoomId}),this.$nextTick((function(){i.$refs.records.scrollTop=i.$refs.records.scrollHeight-i.recordsScrollHeight-20})),this.isLoading=!1;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),500,{leading:!0,trailing:!1}),handleSendReceipt:Object(b["debounce"])(Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:window.matrix.viewingRoom.setReceipt(this.viewingRoomId);case 1:case"end":return e.stop()}}),e,this)}))),500,{leading:!0,trailing:!1}),handleSend:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n="",i=t.text,r=t.mentions,o=t.block,s=i&&i.trim()||"",s){e.next=7;break}return e.abrupt("return");case 7:if(n=r.length?this.hasSignal?this.buildSignalMessage(i,o):this.buildAlertMessage(i,r):this.buildTextMessage(s),!n){e.next=13;break}return this.lastSendMessage=n,this.clearDraft(this.viewingRoomId),e.next=13,this.sendMessage({roomId:this.viewingRoomId,message:n},l["Message"].types.text);case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),buildSignalMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!e)return null;var i="",r=[],o=[];if("object"===Object(a["a"])(t)){var c=[],u=t.entityMap;Object.keys(u).forEach((function(e){var t=u[e];"mention"===t.type&&c.push(e)}));var d=0;t.blocks.forEach((function(e,t){var n=[];n=0===t?lodash.toArray(e.text):["\n"].concat(lodash.toArray(e.text)),i+=n.join(""),e.entityRanges.forEach((function(e){var n=u[e.key].data.mention;if(n){var i=d+e.offset+(0===t?0:1),s=i+e.length;"@"===n.trigger?(r.push({type:n.trigger,val:n.id,start:i,end:s}),o.push(n.id)):r.push({type:n.trigger,val:n.name,start:i,end:s})}})),d+=n.length}))}else i=lodash.toArray(e).join("");var m={msgtype:l["Message"].types.alert,body:i,signals:r.concat.apply(r,Object(s["a"])(n)),idlist:o.concat.apply(o,Object(s["a"])(n.map((function(e){return"@"===e.type?e.val:null})).filter((function(e){return!!e}))))};return m},buildTextMessage:function(e){if(!e)return null;var t={msgtype:"m.text",body:e};return t},buildAlertMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e)return null;var n=t.filter((function(e){return e&&"@"===e.trigger})).map((function(e){return e.id})),i={msgtype:l["Message"].types.alert,body:e,idlist:n};return i},clearDraft:function(e){this.changeValue={},this.$refs.editor&&this.$refs.editor.clearText()},deleteDraft:function(e){var t=this.drafts.filter((function(t){return t.roomId!==e}));this.$matrix.deleteDraft(e),this.$store.dispatchGlobal("drafts",t)},handleUpload:function(e){var t;return(t=this.uploadQueue).unshift.apply(t,Object(s["a"])(e)),!0},handleUploadQueue:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1],i=Fn||104857600,!(t.size>i)){e.next=6;break}return this.$Message.error("仅限发送不超过".concat(i/1048576,"M的文件")),this.uploadQueue.pop(),e.abrupt("return");case 6:if(!n){e.next=10;break}this.handleOtherFileModel(t),e.next=20;break;case 10:if(!t.type.startsWith("image")){e.next=14;break}this.handleImageModel(t),e.next=20;break;case 14:if(!t.type.startsWith("video")){e.next=19;break}return e.next=17,this.handleVideoModel(t);case 17:e.next=20;break;case 19:this.handleOtherFileModel(t);case 20:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleOtherFileModel:function(e){var t="";e.name.split(".")[1]&&(t=e.name.split(".")[1].toLowerCase());var n=nt(t);this.confirmFile={show:!0,title:"发送到:".concat(this.viewingRoom.name.length>16?"".concat(this.viewingRoom.name.slice(0,16),"..."):this.viewingRoom.name),icon:n,type:"file",file:e,name:e.name,size:e.size>1048576?"".concat(parseInt(e.size/1048576,10)," MB"):"".concat(parseInt(e.size/1024,10)," KB")}},handleImageModel:function(e){var t=window.URL.createObjectURL(e);this.confirmFile={show:!0,isImage:!0,title:"发送到:".concat(this.viewingRoom.name.length>16?"".concat(this.viewingRoom.name.slice(0,16),"..."):this.viewingRoom.name),file:e,name:e.name,url:t}},handleVideoModel:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.confirmFile={show:!0,isVideo:!0,title:"发送到:".concat(this.viewingRoom.name.length>16?"".concat(this.viewingRoom.name.slice(0,16),"..."):this.viewingRoom.name),file:t,name:t.name,url:""},e.next=3,w.getThumbVideo(t,MAX_WIDTH,MAX_HEIGHT);case 3:n=e.sent,i=URL.createObjectURL(n.blob),this.confirmFile={show:!0,isVideo:!0,title:"发送到:".concat(this.viewingRoom.name.length>16?"".concat(this.viewingRoom.name.slice(0,16),"..."):this.viewingRoom.name),file:t,name:t.name,url:i};case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleFileConfirmClick:function(e){if(this.confirmFile.show=!1,this.uploadQueue.length){var t=this.uploadQueue.pop();if(!t||!t.size)return void this.$Message.error("无效文件");e?t.type.startsWith("image")?this.handleImage(t):t.type.startsWith("video")?this.handleVideo(t):this.handleOtherFile(t):this.confirmFile.url&&window.URL.revokeObjectURL(this.confirmFile.url)}},handleUploadProgress:function(){},handleImage:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w.getImageInfo(t);case 2:if(n=e.sent,confirm){e.next=5;break}return e.abrupt("return",void 0);case 5:if(n){e.next=8;break}return this.handleOtherFile(t),e.abrupt("return",void 0);case 8:if(i={msgtype:l["Message"].types.image,body:t.name,url:"",info:{mimetype:t.type,size:t.size,w:n.width,h:n.height}},r=t,!this.viewingRoom.isEncryped){e.next=15;break}return e.next=13,this.encryptFile(t);case 13:o=e.sent,o.error||(r=o.file,i.file=o.info);case 15:if(s={},null,e.prev=17,!zn){e.next=24;break}return e.next=21,this.$fcNetdisk.uploadGroup(r,this.viewingRoomId,l["Message"].types.image,i,!1,{},this.handleUploadProgress);case 21:s=e.sent,e.next=27;break;case 24:return e.next=26,this.$fcNetdisk.uploadNative(r,this.viewingRoomId,{},this.handleUploadProgress);case 26:s=e.sent;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e["catch"](17),console.log(e.t0);case 32:if(!s.status){e.next=41;break}return this.viewingRoom.isEncryped&&(i.file.url=s.data.netdiskID),i.url=s.data.netdiskID,i||this.$Message.error("文件发送失败"),e.next=38,this.sendMessage({roomId:this.viewingRoomId,message:i});case 38:e.sent,e.next=42;break;case 41:"token expired"===s.data.data.exp&&u["a"].emit("TOKEN_INVALID");case 42:case"end":return e.stop()}}),e,this,[[17,29]])})));function t(t){return e.apply(this,arguments)}return t}(),removePendingEvent:function(e){try{var t=this.rawRoom.findEventById(e);this.rawRoom.updatePendingEvent(t,"queued"),this.$matrix.get().cancelPendingEvent(t)}catch(n){}},handleVideo:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,o,s,a,c,d,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w.getThumbVideo(t,MAX_WIDTH,MAX_HEIGHT);case 2:if(n=e.sent,n){e.next=6;break}return this.handleOtherFile(t),e.abrupt("return",null);case 6:if(i=URL.createObjectURL(n.blob),r={msgtype:l["Message"].types.video,body:t.name,url:"",info:{mimetype:t.type,size:t.size,w:n.width,h:n.height,duration:n.duration,thumbnail_url:i,thumbnail_info:n.info}},o=this.setMockMessage(r,t),s=t,!this.viewingRoom.isEncryped){e.next=15;break}return e.next=13,this.encryptFile(t);case 13:a=e.sent,a.error||(s=a.file,r.file=a.info);case 15:if(c={},d={},m=this.rawRoom.findEventById(o),e.prev=18,!zn){e.next=25;break}return e.next=22,this.$fcNetdisk.uploadGroup(n.blob,this.viewingRoomId,l["Message"].types.image,r,!0);case 22:c=e.sent,e.next=28;break;case 25:return e.next=27,this.$fcNetdisk.uploadNative(n.blob,this.viewingRoomId);case 27:c=e.sent;case 28:e.next=33;break;case 30:e.prev=30,e.t0=e["catch"](18),console.log(e.t0);case 33:if(c.status&&(window.URL.revokeObjectURL(r.info.thumbnail_url),r.info.thumbnail_url=c.data.netdiskID),e.prev=34,!zn){e.next=41;break}return e.next=38,this.$fcNetdisk.uploadGroup(s,this.viewingRoomId,l["Message"].types.video,r,!1,m,this.handleUploadProgress);case 38:d=e.sent,e.next=44;break;case 41:return e.next=43,this.$fcNetdisk.uploadNative(s,this.viewingRoomId,m,this.handleUploadProgress);case 43:d=e.sent;case 44:e.next=49;break;case 46:e.prev=46,e.t1=e["catch"](34),console.log(e.t1);case 49:if(!d.status){e.next=58;break}return r.url=d.data.netdiskID,r||(this.$Message.error("文件发送失败"),this.handlePendingEventError(o)),this.removePendingEvent(o),e.next=55,this.sendMessage({roomId:this.viewingRoomId,message:r});case 55:e.sent,e.next=59;break;case 58:"token expired"===d.data.data.exp?u["a"].emit("TOKEN_INVALID"):(this.handlePendingEventError(o),window.URL.revokeObjectURL(i));case 59:case"end":return e.stop()}}),e,this,[[18,30],[34,46]])})));function t(t){return e.apply(this,arguments)}return t}(),handleOtherFile:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={msgtype:l["Message"].types.file,body:t.name,url:"",info:{mimetype:t.type,size:t.size}},i=t,!this.viewingRoom.isEncryped){e.next=7;break}return e.next=5,this.encryptFile(t);case 5:r=e.sent,r.error||(i=r.file,n.file=r.info);case 7:if(o={},s=null,e.prev=9,!zn){e.next=16;break}return e.next=13,this.$fcNetdisk.uploadGroup(i,this.viewingRoomId,l["Message"].types.file,n,!1,s,this.handleUploadProgress);case 13:o=e.sent,e.next=19;break;case 16:return e.next=18,this.$fcNetdisk.uploadNative(i,this.viewingRoomId,s,this.handleUploadProgress);case 18:o=e.sent;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e["catch"](9),console.log(err);case 24:if(!o.status){e.next=33;break}return this.viewingRoom.isEncryped&&(n.file.url=o.data.netdiskID),n.url=o.data.netdiskID,n||this.$Message.error("文件发送失败"),e.next=30,this.sendMessage({roomId:this.viewingRoomId,message:n});case 30:e.sent,e.next=34;break;case 33:"token expired"===o.data.data.exp&&u["a"].emit("TOKEN_INVALID");case 34:case"end":return e.stop()}}),e,this,[[9,21]])})));function t(t){return e.apply(this,arguments)}return t}(),setMockMessage:function(e,t){var n=Hn.get().makeTxnId();return this.viewingRoom.roomId?n:{mxEvent:null,txnId:n}}},computed:Nn({},Object(d["b"])(["showRoomList","windowHeight","windowWidth","userList","myinfo","hasOldTimelineTable","chatRoom","roomListWidth","editorHeight","editorDraging"]),{roomList:function(){return this.$store.state.roomList},roomTimeLine:function(){return console.log("VUEX STORE: roomTimeLine"),console.log(this.$store.state.roomTimeLine),this.$store.state.roomTimeLine[this.viewingRoomId]&&this.$store.state.roomTimeLine[this.viewingRoomId].filter((function(e){return!e.isRedacted}))},viewingRoom:function(){var e=this;return this.roomList.find((function(t){return t.roomId===e.viewingRoomId}))||{}}}),watch:{uploadQueue:function(e){if(e.length){var t=e[e.length-1];this.handleUploadQueue(t)}}}},Wn=Vn,Qn=(n("81a7"),Object(C["a"])(Wn,i,r,!1,null,null,null));t["default"]=Qn.exports},fba3:function(e,t,n){}}]);